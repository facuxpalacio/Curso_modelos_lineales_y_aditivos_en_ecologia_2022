avg.m2c<-model.avg(dredge.m2c, subset = delta < 2)
dredge.m2c<-dredge(m2c,rank="AICc")
dredge.m2c
base.completa<-read.table("C:/RD/orden.completa.txt",head=T,dec=",")
base.completa<-read.table("C:/RD/orden.completa2.txt",head=T,dec=",")
base.completa$long.planta<-as.numeric(base.completa$long.planta)
base.completa2<-na.omit(base.completa)
table(base.completa$orden)
base.completa2$id.parche<-as.factor(base.completa2$id.parche)
base.completa2$area<-as.numeric(base.completa2$area)
hist(base.completa$n.visitas)
hist(base.completa$capvisit)
m5<-glmmTMB(capvisit ~ trat + fecha + orden + trat:fecha + trat:orden + pcapxarea + capxpl +
m6<-glmmTMB(capvisit ~ trat + fecha + orden + trat:fecha + trat:orden + pcapxarea + capxpl +
(1|id.parche), family=nbinom1, data=base.completa2)
head(base.completa2)
df<-read.table("C:/RD/verbeseed2.txt",head=T,dec=",")
levels(df$clausura)
levels(df$clausura)[levels(df$clausura)=="embolsado"]<-"clausura"
levels(df$clausura)
#Resumenes
capN<-with(df,tapply(id.plant,list(clausura),length))
capN
N2<-with(df,tapply(n.cap,list(morfo.sem2,clausura),length))
N2
ce<-ce<-(ms[1]*mc[1])/np[1]
ms<-with(df,tapply(n.semillas,list(morfo.sem2,clausura),mean))
ce<-ce<-(ms[1]*mc[1])/np[1]
plot(m3)
plot(m2)
library(piecewiseSEM)
library(MASS)
plants <- read.table("C:/RD/Data Passiflora AOS_2020_plants.txt", head=T)
f_urb <- factor(plants$idpopulation,
levels = c("La_Plata", "Magdalena", "Ranchos"),
labels = c("3", "1", "2"))
plants$urb_level <- as.numeric(levels(f_urb)[f_urb])
plants$urb_level2 <- plants$urb_level^2
plants <- na.omit(plants[, c(7:8, 11, 13, 17, 20:22)])
#### Raw estimates assuming different error distributions
## M1. Influence of urbanization on bird visitation
M1 <- psem(
# Influence of urbanization on fruit traits
glm.nb(crop ~ urb_level + urb_level2, data = plants),
lm(x.diam ~ urb_level + urb_level2, data = plants),
lm(x.nseeds ~ urb_level + urb_level2, data = plants),
lm(x.peel.sugar ~ urb_level + urb_level2 + crop, data = plants),
# Fruit traits and fitness
glm(visits ~ urb_level + urb_level2 + crop + x.diam + x.nseeds + x.peel.sugar,
family = poisson, data = plants),
# Correlation between fitness measures
fruit_rem %~~% visits,
# Fruit trait correlations
x.nseeds %~~% x.diam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
resM1 <- summary(M1, direction = c("x.nseeds <- crop"))
# M2. Influence of urbanization on fruit removal
M2 <- psem(
# Influence of urbanization on fruit traits
glm.nb(crop ~ urb_level + urb_level2, data = plants),
lm(x.diam ~ urb_level + urb_level2, data = plants),
lm(x.nseeds ~ urb_level + urb_level2, data = plants),
lm(x.peel.sugar ~ urb_level + urb_level2 + crop, data = plants),
# Fruit traits and fitness
glm(visits ~ urb_level + urb_level2 + crop + x.diam + x.nseeds + x.peel.sugar,
family = poisson, data = plants),
# New paths: influence of fruit traits and urbanization on fruit removal
glm.nb(fruit_rem ~ urb_level + urb_level2 + crop + x.diam + x.nseeds + x.peel.sugar,
data = plants),
# Correlation between fitness measures
fruit_rem %~~% visits,
# Fruit trait correlations
x.nseeds %~~% x.diam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
resM2 <- summary(M2, direction = c("x.nseeds <- crop"))
# M3. Urbanization has an interactive effect with fruit traits on selection
M3 <- psem(
# Influence of urbanization on fruit traits
glm.nb(crop ~ urb_level + urb_level2, data = plants),
lm(x.diam ~ urb_level + urb_level2 , data = plants),
lm(x.nseeds ~ urb_level + urb_level2, data = plants),
lm(x.peel.sugar ~ urb_level + urb_level2 + crop, data = plants),
# New paths: Fruit traits and fitness interaction with urbanization
glm(visits ~ urb_level*crop + urb_level*x.diam + urb_level*x.nseeds +
urb_level*x.peel.sugar, family = poisson,
data = plants),
# Correlation between fitness measures
fruit_rem %~~% visits,
# Fruit trait correlations
x.nseeds %~~% x.diam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
resM3 <- summary(M3, direction = c("x.nseeds <- crop"))
# M4. Visits are influenced by fruit traits rather than by urbanization,
# fruit removal is not influenced by urbanization
M4 <- psem(
# Influence of urbanization on fruit traits
glm.nb(crop ~ urb_level + urb_level2, data = plants),
lm(x.diam ~ urb_level + urb_level2, data = plants),
lm(x.nseeds ~ urb_level + urb_level2, data = plants),
lm(x.peel.sugar ~ urb_level + urb_level2 + crop, data = plants),
# Fruit traits and fitness
glm(visits ~ crop + x.diam + x.nseeds + x.peel.sugar,
family = poisson, data = plants),
# Correlation between fitness measures
fruit_rem %~~% visits,
# Fruit trait correlations
x.nseeds %~~% x.diam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
resM4 <- summary(M4, direction = c("x.nseeds <- crop"))
resM1$IC
resM2$IC
resM3$IC
resM4$IC
resM1$Cstat
resM2$Cstat
resM3$Cstat
resM4$Cstat
write.csv(coefs(M4),"coefs_M4.csv")
write.csv(resM4$dTable,"dTable_M4.csv")
write.csv(resM4$Cstat,"Cstat_M4.csv")
write.csv(resM4$IC,"IC_M4.csv")
write.csv(resM4$R2,"R2_M4.csv")
resM4
# M4. Visits are influenced by fruit traits rather than by urbanization,
# fruit removal is not influenced by urbanization
M4 <- psem(
# Influence of urbanization on fruit traits
lm(zcrop ~ urb_level + urb_level2, data = zdata),
lm(zdiam ~ urb_level + urb_level2 + zcrop, data = zdata),
lm(znseeds ~ urb_level + urb_level2 + zcrop, data = zdata),
lm(zpeel.sugar ~ urb_level + urb_level2 + zcrop, data = zdata),
# Fruit traits and fitness
lm(wvisits ~ zcrop + zdiam + znseeds + zpeel.sugar, data = zdata),
# Correlation between fitness measures
wfruit_rem %~~% wvisits,
# Fruit trait correlations
znseeds %~~% zdiam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
zdata <- na.omit(data.frame(urb_level = plants$urb_level,
urb_level2 = plants$urb_level2,
zcrop = scale(plants$crop),
zdiam = scale(plants$x.diam),
znseeds = scale(plants$x.nseeds),
zpeel.sugar = scale(plants$x.peel.sugar),
wvisits = plants$visits/mean(plants$fruit_rem),
wfruit_rem = plants$fruit_rem/mean(plants$fruit_rem)))
# M4. Visits are influenced by fruit traits rather than by urbanization,
# fruit removal is not influenced by urbanization
M4 <- psem(
# Influence of urbanization on fruit traits
lm(zcrop ~ urb_level + urb_level2, data = zdata),
lm(zdiam ~ urb_level + urb_level2 + zcrop, data = zdata),
lm(znseeds ~ urb_level + urb_level2 + zcrop, data = zdata),
lm(zpeel.sugar ~ urb_level + urb_level2 + zcrop, data = zdata),
# Fruit traits and fitness
lm(wvisits ~ zcrop + zdiam + znseeds + zpeel.sugar, data = zdata),
# Correlation between fitness measures
wfruit_rem %~~% wvisits,
# Fruit trait correlations
znseeds %~~% zdiam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
resM4 <- summary(M4)
resM4$coefficients
resM4$coefficients
write.csv(resM4$coefficients$Std.Estimate, "zcoeff.M4.csv")
resM4$coefficients
write.csv(resM4$coefficients, "zcoeff.M4.csv")
# M4. Visits are influenced by fruit traits rather than by urbanization,
# fruit removal is not influenced by urbanization
M4 <- psem(
# Influence of urbanization on fruit traits
lm(zcrop ~ urb_level + urb_level2, data = zdata),
lm(zdiam ~ urb_level + urb_level2, data = zdata),
lm(znseeds ~ urb_level + urb_level2, data = zdata),
lm(zpeel.sugar ~ urb_level + urb_level2 + zcrop, data = zdata),
# Fruit traits and fitness
lm(wvisits ~ zcrop + zdiam + znseeds + zpeel.sugar, data = zdata),
# Correlation between fitness measures
wfruit_rem %~~% wvisits,
# Fruit trait correlations
znseeds %~~% zdiam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
resM4 <- summary(M4)
setwd("C:/Users/54221/Dropbox/Publicaciones/Passiflora y urbanización/Resultados")
write.csv(resM4$coefficients, "zcoeff.M4.csv")
citation()
library(caper)
?shorebird
data(shorebird)
head(shorebird)
head(shorebird.data)
?comparative.data
shorebird <- comparative.data(phy = shorebird.tree, data = shorebird.data, names.col = Species, vcv = TRUE)
shorebird <- comparative.data(phy = shorebird.tree, data = shorebird.data, names.col = Species, vcv = TRUE)
normal.phyloglmm <- pgls(log(Egg.Mass) ~ log(M.Mass), data = shorebird)
normal.glm <- glm(log(Egg.mass) ~ log(M.Mass), data = shorebird.data)
head(shorebird.data)
normal.glm <- glm(log(Egg.Mass) ~ log(M.Mass), data = shorebird.data)
normal.glm <- glm(log(Egg.Mass) ~ log(M.Mass), data = shorebird.data)
2+2
library(caper)
shorebird <- comparative.data(phy = shorebird.tree, data = shorebird.data, names.col = Species, vcv = TRUE)
library(caper)
data(shorebirds)
shorebird <- comparative.data(phy = shorebird.tree, data = shorebird.data, names.col = Species, vcv = TRUE)
library(caper)
data(shorebirds)
shorebird <- comparative.data(phy = shorebird.tree, data = shorebird.data, names.col = Species, vcv = TRUE)
data(shorebirds)
library(caper)
data(shorebirds)
library(caper)
data(shorebird)
shorebird <- comparative.data(phy = shorebird.tree, data = shorebird.data, names.col = Species, vcv = TRUE)
normal.phyloglmm <- pgls(log(Egg.Mass) ~ log(M.Mass), data = shorebird)
summary(normal.phyloglmm)
normal.glm <- glm(log(Egg.Mass) ~ log(M.Mass), data = shorebird.data)
summary(normal.glm)
library(phyloglm)
plot(shorebird.tree)
library(phylolm)
summary(normal.phyloglmm)
summary(normal.glm)
hist(shorebird.data$Egg.Mass)
shorebird.data$Egg.Mass.binary <- ifelse(shorebird.data$Egg.Mass > 40, 1, 0)
shorebird.data$Egg.Mass.binary <- ifelse(shorebird.data$Egg.Mass > 40, 1, 0)
binomial.glm <- phylolm(Egg.Mass.binary ~ M.Mass, phy = shorebird.tree, data = shorebird.data, boot = 100)
summary(binomial.glm)
normal.phyloglmm <- pgls(log(Egg.Mass) ~ F.Mass, data = shorebird)
summary(normal.phyloglmm)
normal.glm <- glm(log(Egg.Mass) ~ F.Mass, data = shorebird.data)
summary(normal.glm)
plot(shorebird.data$F.Mass, shorebird.data$Egg.Mass.binary)
plot(shorebird.data$F.Mass, shorebird.data$Egg.Mass)
plot(shorebird.data$F.Mass, shorebird.data$Egg.Mass.binary)
binomial.glm <- phylolm(Egg.Mass.binary ~ F.Mass, phy = shorebird.tree, data = shorebird.data, boot = 100)
summary(binomial.glm)
binomial.glm <- phylolm(Egg.Mass.binary ~ F.Mass, phy = shorebird.tree, data = shorebird.data, method = "logistic_IG10", boot = 100)
summary(binomial.glm)
?phylolm
?phyloglm
AIC(normal.phyloglmm, normal.glm)
binomial.glm <- phyloglm(Egg.Mass.binary ~ F.Mass, phy = shorebird.tree, data = shorebird.data, method = "logistic_IG10", boot = 100)
shorebird.data$Egg.Mass.binary <- ifelse(shorebird.data$Egg.Mass > 30, 1, 0)
plot(shorebird.data$F.Mass, shorebird.data$Egg.Mass.binary)
binomial.glm <- phyloglm(Egg.Mass.binary ~ F.Mass, phy = shorebird.tree, data = shorebird.data, method = "logistic_IG10", boot = 100)
yes
binomial.glm <- phyloglm(Egg.Mass.binary ~ F.Mass, phy = shorebird.tree, data = shorebird.data, method = "logistic_MPLE", boot = 100)
summary(binomial.glm)
1/(1+exp(20))
binomial.glm <- phyloglm(Egg.Mass.binary ~ F.Mass, phy = shorebird.tree, data = shorebird.data, method = "logistic_MPLE", boot = 100, btol = 20)
binomial.glm <- phyloglm(Egg.Mass.binary ~ F.Mass, phy = shorebird.tree, data = shorebird.data, method = "logistic_MPLE", boot = 100, btol = 30)
summary(binomial.glm)
set.seed(999)
layout(matrix(1:4, 2, 2))
x <- rnorm(100)
y1 <- 2 + 1.5*x
plot(x, y1)
y2 <- 2 + 1.5*x - 0.2*x^2
plot(x, y2)
y3 <- exp(x)
plot(x, y3)
y4 <- log(y3)
plot(x, y4)
layout(1)
set.seed(999)
layout(matrix(1:4, 2, 2))
x <- rnorm(100)
y1 <- 2 + 1.5*x
plot(x, y1)
y2 <- 2 + 1.5*x - 0.2*x^2
plot(x, y2)
y3 <- exp(x)
plot(x, y3)
y4 <- log(y3)
plot(x, y4)
layout(1)
x <- rnorm(100)
e <- rnorm(100, mean = 0, sd = 1)
y <- 2 + 1.5*x + e
plot(x, y)
cov(x, y)
cov(x, y)/(sd(x)*sd(y))
cor(x, y, method = "pearson")
cor.test(x, y)
layout(matrix(1:4, 2, 2))
x1 <- seq(1, 10, length = 100)
y1 <- 0.5 + 2*x1
plot(x1, y1, type = "l")
y2 <- 0.5 + 2*x1 - 0.2*x1^2
plot(x1, y2, type = "l")
y3 <- exp(-5 + x1)
plot(x1, y3, type = "l")
y4 <- exp(-5 + x1)/(1 + exp(-5 + x1))
plot(x1, y4, type = "l")
layout(1)
x <- rnorm(100)
e <- rnorm(100, mean = 0, sd = 1)
y <- 2 + 1.5*x + e
plot(x, y)
datos <- data.frame(x, y)
reg.simple <- lm(y ~ x, data = datos)
summary(reg.simple)
summary(reg.simple)$r.squared
SCE <- sum((mean(datos$y) - reg.simple$fitted)^2) # suma de cuadrados explicada
SCT <- sum((datos$y - mean(datos$y))^2) # suma de cuadrados total
R2 <- SCE/SCT
R2
abline(reg.simple, lwd = 2)
beta*sd(x)/sd(y)
beta <- summary(reg.simple)$coeff[2, 1]
beta*sd(x)/sd(y)
sqrt(summary(reg.simple)$r.squared)
cor(x, y)
pairs(Ad[, 3:6], pch = 19, col = "blue", lower.panel = NULL)
library(palmerpenguins)
str(penguins)
cor(penguins[, 3:6], use = "complete.obs")
pairs(penguins[, 3:6])
Ad <- subset(penguins, species == "Adelie")
model.Ad <- lm(bill_length_mm ~ body_mass_g + bill_depth_mm, data = Ad)
pairs.panels(Ad[, 3:6],
method = "pearson", # correlación
density = FALSE,  # gráficos de densidad
ellipses = FALSE, # elipses de confianza
lm = TRUE) # recta
library(psych)
pairs.panels(Ad[, 3:6],
method = "pearson", # correlación
density = FALSE,  # gráficos de densidad
ellipses = FALSE, # elipses de confianza
lm = TRUE) # recta
model.Ad <- lm(bill_length_mm ~ body_mass_g + bill_depth_mm, data = Ad)
summary(model.Ad)
sum.cuad.exp <- sum((mean(na.omit(Ad$bill_length_mm)) - model.Ad$fitted)^2)
sum.cuad.tot <- sum((na.omit(Ad$bill_length_mm) - mean(na.omit(Ad$bill_length_mm)))^2)
R2 <- sum.cuad.exp/sum.cuad.tot
R2
library(plot3D)
x <- Ad$body_mass_g
y <- Ad$bill_depth_mm
z <- Ad$bill_length_mm
x.pred <- seq(min(x, na.rm = T), max(x, na.rm = T), length = 30)
y.pred <- seq(min(y, na.rm = T), max(y, na.rm = T), length = 30)
xy <- expand.grid(body_mass_g = x.pred, bill_depth_mm = y.pred)
z.pred <- matrix(predict(model.Ad, newdata = xy), nrow = 30, ncol = 30)
scatter3D(x, y, z, pch = 18, cex = 2,
theta = 35, phi = 20, ticktype = "detailed",
xlab = "Masa corporal", ylab = "Alto del pico",
zlab = "Longitud del pico",
surf = list(x = x.pred, y = y.pred, z = z.pred, facets = NA))
library(visreg)
Ad$bill_depth_cat <- cut(Ad$bill_depth_mm, 3,
labels = c("Small", "Intermediate", "Large"))
model.Ad_cat <- lm(bill_length_mm ~ body_mass_g + bill_depth_cat, data = Ad)
visreg(model.Ad_cat, "body_mass_g", "bill_depth_cat", gg = TRUE)
model.Ad_cat <- lm(bill_length_mm ~ body_mass_g + bill_depth_cat, data = Ad)
visreg(model.Ad_cat, "body_mass_g", "bill_depth_cat", gg = TRUE)
Ad$bill_depth_cat <- cut(Ad$bill_depth_mm, 3,
labels = c("Pequeño", "Mediano", "Grande"))
model.Ad_cat <- lm(bill_length_mm ~ body_mass_g + bill_depth_cat, data = Ad)
visreg(model.Ad_cat, "body_mass_g", "bill_depth_cat", gg = TRUE)
model.penguins1 <- lm(bill_length_mm ~ body_mass_g + species, data = penguins)
summary(model.penguins1)
model.penguins2 <- lm(bill_length_mm ~ body_mass_g + species + body_mass_g:species, data = penguins)
summary(model.penguins2)
anova(model.penguins2)
t_coag <- c(8.8, 8.4, 7.9, 8.7, 9.1, 9.6, 9.5,
9.9, 9.0, 11.1, 9.6, 8.7, 10.4, 9.5)
droga <- c(rep("A", 7), rep("B", 7))
coag <- data.frame(t_coag, droga)
t.test(t_coag ~ droga, var.equal = TRUE, data = coag)
model.coag <- lm(t_coag ~ droga, data = coag)
summary(model.coag)
X_drogaA <- mean(t_coag[1:7])
X_drogaB <-  mean(t_coag[8:14])
X_drogaB - X_drogaA
var.test(t_coag[1:7], t_coag[8:14])
fotosint <- c(1.42, 1.4, 1.44, 1.44, 1.42, 1.46, 1.49, 1.5, 1.42, 1.48,
1.38, 1.36, 1.47, 1.39, 1.43, 1.41, 1.43, 1.45, 1.36, 1.46)
nutriente <- c(rep("N1", 10), rep("N2", 10))
plantas <- data.frame(fotosint, nutriente)
t.test(fotosint ~ nutriente, paired = TRUE, data = plantas)
boxplot(penguins$bill_length_mm ~ penguins$species)
model.spp <- aov(bill_length_mm ~ species, data = na.omit(penguins))
summary(model.spp)
summary(lm(bill_length_mm ~ species, data = na.omit(penguins)))
TukeyHSD(model.spp)
library(car)
vif(model.Ad)
hist(model.Ad$residuals)
qqPlot(model.Ad$residuals)
layout(matrix(1:4, 2, 2))
plot(model.Ad)
layout(1)
model.spp <- aov(bill_length_mm ~ species, data = na.omit(penguins))
resid.model.spp <- resid(model.spp)
boxplot(resid.model.spp ~ species, data = na.omit(penguins))
termplot(model.spp, se = TRUE, partial.resid = TRUE)
bartlett.test(resid.model.spp ~ species, data = na.omit(penguins))
# Analisis exploratorio
datos <- read.table("C:/RD/Solea.txt", header = TRUE)
str(datos)
hist(datos$Solea_solea)
table(datos$Solea_solea)
pairs(datos[, 4:12])
round(cor(datos[, 4:12]), 2)
# Analisis exploratorio
datos <- read.table("C:/RD/Solea.txt", header = TRUE)
str(datos)
hist(datos$Solea_solea)
table(datos$Solea_solea)
pairs(datos[, 4:12])
round(cor(datos[, 4:12]), 2)
m.bin <- glm(Solea_solea ~ temperature + transparency + salinity, family = binomial, data = datos)
summary(m.bin)
summary(m.bin)
# Pseudo-R2
1 - (m.bin$dev/m.bin$null)
library(performance)
# Coeficiente de determinación de Tjur
r2_tjur(m.bin)
# Análisis exploratorio
h <- read.table("C:/RD/hormigas.txt", header = T)
str(h)
h$Habitat <- as.factor(h$Habitat)
pairs(h[, 2:5])
round(cor(h[, c(2, 4:5)]), 2)
plot(table(h$Srich), xlab = "Numero de especies", ylab = "Frecuencia")
hist(h$Srich, xlab = "Numero de especies", ylab = "Frecuencia relativa", main = "", freq = FALSE)
# Ajuste de distribución a los datos
sim.pois <- dpois(x = 0:max(h$Srich), lambda = mean(h$Srich))
lines(x = 0:max(h$Srich), y = sim.pois, col = "blue", lwd = 2, type = "b")
var(h$Srich)/mean(h$Srich)
# Análisis exploratorio
h <- read.table("C:/RD/hormigas.txt", header = T)
str(h)
h$Habitat <- as.factor(h$Habitat)
pairs(h[, 2:5])
round(cor(h[, c(2, 4:5)]), 2)
plot(table(h$Srich), xlab = "Número de especies", ylab = "Frecuencia")
hist(h$Srich, xlab = "Número de especies", ylab = "Frecuencia relativa", main = "", freq = FALSE)
# Ajuste de distribución a los datos
sim.pois <- dpois(x = 0:max(h$Srich), lambda = mean(h$Srich))
lines(x = 0:max(h$Srich), y = sim.pois, col = "blue", lwd = 2, type = "b")
var(h$Srich)/mean(h$Srich)
m.pois <- glm(Srich ~ Latitude + Elevation + Habitat, family = poisson, data = h)
summary(m.pois)
m.qpois <- glm(Srich ~ Latitude + Elevation + Habitat, family = quasipoisson, data = h)
summary(m.qpois)
# Parámetro de sobredispersión
resid <- residuals(m.qpois, type = "pearson")
nparam <- length(m.qpois$coeff)
ndatos <- nrow(h)
disp.param <- sum(resid^2)/(ndatos - nparam)
disp.param
m.qpois.null <- glm(Srich ~ 1, family = quasipoisson, data = h)
summary(m.qpois.null)
library(DHARMa)
testDispersion(m.pois)
?rnbinom
hist(rpois(100,lambda=5))
hist(rnbinom(100,10,prob=0.7))
hist(rnbinom(n=100,mu=5,size=2))
hist(rnbinom(n=100,mu=5,size=5))
hist(rnbinom(n=100,mu=5,size=1))
hist(rpois(100,lambda=3))
hist(rnbinom(n=100,mu=3,size=1))
hist(rpois(100,lambda=3),xlim=c(0,15))
hist(rnbinom(n=100,mu=3,size=100))
hist(rnbinom(n=100,mu=3,size=100),xlim=c(0,15))
hist(rnbinom(n=100,mu=3,size=30),xlim=c(0,15))
m.qpois <- glm(Srich ~ Latitude + Elevation + Habitat, family = quasipoisson, data = h)
summary(m.qpois)
# Parámetro de sobredispersión
resid <- residuals(m.qpois, type = "pearson")
nparam <- length(m.qpois$coeff)
ndatos <- nrow(h)
disp.param <- sum(resid^2)/(ndatos - nparam)
disp.param
m.qpois.null <- glm(Srich ~ 1, family = quasipoisson, data = h)
summary(m.qpois.null)
library(DHARMa)
testDispersion(m.pois)
data<-read.txt("C:/RD/Phocoena_dataset.txt",head=T)
head(data)
dataw<-read.txt("C:/RD/Phocoena_dataset.txt",head=T)
dataw<-read.table("C:/RD/Phocoena_dataset.txt",head=T)
head(dataw)
plot(dataw$Month_EST,dataw$DPH_Porp)
library(mgcv)
m<-gam(DPH_Porp~s(Month_EST),family=binomial, data=dataw)
summary(m)
plot(m)
head(dataw)
table(dataw$Day_EST)
m<-gam(cbind(Day_EST,DPH_Porp)~s(Month_EST),family=binomial, data=dataw)
summary(m)
