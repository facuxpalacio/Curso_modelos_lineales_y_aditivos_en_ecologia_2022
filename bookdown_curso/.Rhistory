10^(1/5)
hist(rnorm(100),breaks=10)
hist(rnorm(100),breaks=50)
hist(rnorm(100))
hist(rnorm(100),breaks=15)
x<-rpois(500,lambda=1)
hist(x)
hist(rpois(500, lambda=5))
hist(rpois(500, lambda=100))
var(rpois(500,lambda=100)
)
hist(rnorm(500,mean=10,sd=100))
barplot(x)
table(x)
barplot(table(x))
x<-c(1, 4, 7, 11, 5, 2)
y<-c(1, 2, 3, 4, 5, 6)
x+y
x*y
3*y
seq(10,11.3, by=0.1)
seq(9,7,by=2)
seq(7,9,by=-2)
?seq
seq(9,7)
seq(9,1,by=2)
seq(9,1)
seq(9,1,by=-2)
datos <- read.table("C:/RD/Solea.txt", header = TRUE)
m.bin <- glm(Solea_solea ~ temperature + transparency + salinity, family = binomial, data = datos)
obs <- datos$Solea_solea
pred.df <- data.frame(obs, pred = predict(m.bin, type = "response"))
head(pred.df)
p0 <- subset(pred.df, obs == 0)
p1 <- subset(pred.df, obs == 1)
p0
data(ChickWeight)
?ChickWeight
head(ChickWeight)
library(mgcv)
m<-gamm(Weight ~ s(Time), random = list(Chick=~1), data = ChickWeight)
m<-gamm(weight ~ s(Time), random = list(Chick=~1), data = ChickWeight)
summary(m)
summary(m$gam)
plot(m$gam)
library(ggplot2)
ggplot(data = Salamanders, aes(x = Wtemp, y = count)) +
geom_point() + facet_wrap(Site) +
theme_bw()
library(glmmTMB)
data(Salamanders)
ggplot(data = Salamanders, aes(x = Wtemp, y = count)) +
geom_point() + facet_wrap(Site) +
theme_bw()
head(Salamanders)
ggplot(data = Salamanders, aes(x = Wtemp, y = count)) +
geom_point() + facet_wrap(site) +
theme_bw()
ggplot(data = Salamanders, aes(x = Wtemp, y = count)) +
geom_point() + facet_wrap(~site) +
theme_bw()
head(biolum)
biolum <- read.table("C:/RD/ISIT.txt", header = TRUE)
head(biolum)
ggplot(data = biolum, aes(x = SampleDepth, y = Sources)) +
geom_point() + facet_wrap(~Station) +
theme_bw()
gam0 <- gam(Sources ~ s(SampleDepth), family = gaussian, data = Salamanders)
gam0 <- gam(Sources ~ s(SampleDepth), family = gaussian, data = biolum)
# Intercepto aleatorio
gamm1 <- gamm(Sources ~ s(SampleDepth), random = list(Station = ~1), family = gaussian, data = biolum)
# Intercepto y "pendiente" aleatorios
gamm2 <- gamm(Sources ~ s(SampleDepth), random = list(Station = ~1 + SampleDepth|Station), family = gaussian, data = biolum)
AIC(gam0, gamm1$lme, gamm2$lme)
plot(gamm2$gam)
library(itsadug)
gamtabs(gamm2)
gamtabs(gamm2$gam)
gamtabs(gamm2$gam)
gamtabs(gamm2$gam, type = "html")
gamtabs(gamm2$gam, type = "html")
plot_smooth(gamm2$gam)
plot_smooth(gamm2$gam, view = "SampleDepth")
plot_smooth(gamm2, view = "SampleDepth")
head(biolum)
str(biolum)
table(biolum$Year)
ggplot(data = biolum, aes(x = SampleDepth, y = Sources)) +
geom_point() + facet_wrap(~Year) +
theme_bw()
gam0 <- gam(Sources ~ Year + s(SampleDepth), family = gaussian, data = biolum)
# Intercepto aleatorio
gamm1 <- gamm(Sources ~ Year + s(SampleDepth), random = list(Station = ~1), family = gaussian, data = biolum)
# Intercepto y "pendiente" aleatorios
gamm2 <- gamm(Sources ~ Year + s(SampleDepth), random = list(Station = ~1 + SampleDepth|Station), family = gaussian, data = biolum)
AIC(gam0, gamm1$lme, gamm2$lme)
summary(gamm2$gam)
gamtabs(gamm2$gam, type = "HTML")
plot_smooth(gamm2$gam, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
str(biolum)
base<-read.table("C:/RD/sturnus llavallol.txt",head=T)
library(lme4)
stand<-function(x){(x-min(x))/(max(x)-min(x))}
xtru<-mean(stand(base$tru))
xmbo<-mean(stand(base$mbo))
xzau<-mean(stand(base$zau))
xaba<-mean(stand(base$aba))
# negativas
xcli<-mean(stand(base$cli))
xpdo<-mean(stand(base$pdo))
xcpi<-mean(stand(base$cpi))
xmmo<-mean(stand(base$mmo))
meanX<-data.frame(tru=xtru,mbo=xmbo,zau=xzau,aba=xaba,cli=xcli,pdo=xpdo,cpi=xcpi,mmo=xmmo)
# modelo promedio
b0<-mean(c(0.494332,0.494332+0.227383,0.494332-0.397660,0.494332-0.435377))
cli<--0.305371
tru<-0.096011
mbo<-0.029545
pdo<--0.001799
zau<-0.002457
aba<-0.007100
cpi<--0.004357
mmo<--0.001493
b<-as.matrix(c(b0,tru,mbo,zau,aba,cli,pdo,cpi,mmo))
X<-seq(0,1,length=500)
y.tru<-exp(as.matrix(cbind(1,data.frame(tru=X,meanX[,-1]))) %*% b)
y.mbo<-exp(as.matrix(cbind(1,meanX[,1],mbo=X,meanX[,3:8])) %*% b)
y.zau<-exp(as.matrix(cbind(1,meanX[,1:2],zau=X,meanX[,4:8])) %*% b)
y.aba<-exp(as.matrix(cbind(1,meanX[,1:3],aba=X,meanX[,5:8])) %*% b)
y.cli<-exp(as.matrix(cbind(1,meanX[,1:4],cli=X,meanX[,6:8])) %*% b)
y.pdo<-exp(as.matrix(cbind(1,meanX[,1:5],pdo=X,meanX[,7:8])) %*% b)
y.cpi<-exp(as.matrix(cbind(1,meanX[,1:6],cpi=X,meanX[,8])) %*% b)
y.mmo<-exp(as.matrix(cbind(1,data.frame(meanX[,-8]),mmo=X)) %*% b)
plot(X,y.tru,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5)
lines(X,y.mbo,lwd=2)
lines(X,y.zau,lwd=2)
lines(X,y.aba,lwd=2)
text(x=c(0.75,0.9,0.9,0.9),y=c(1.5,1.465,1.415,1.435),labels=c("Truf","Mbon","Zaur","Abad"))
par(mar=c(4,6,4,4)) # 7x5 in
plot(X,y.tru,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5)
lines(X,y.mbo,lwd=2)
lines(X,y.zau,lwd=2)
lines(X,y.aba,lwd=2)
text(x=c(0.75,0.9,0.9,0.9),y=c(1.5,1.465,1.415,1.435),labels=c("Truf","Mbon","Zaur","Abad"))
plot(X,y.cli,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5)
lines(X,y.pdo,lwd=2)
lines(X,y.cpi,lwd=2)
lines(X,y.mmo,lwd=2)
text(x=c(0.9,0.9,0.9,0.9),y=c(1.12,1.43,1.4),labels=c("Cliv","Pdom-Mmon","Cpic"))
plot(X,y.cli,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5)
head(base)
plot(X,y.tru,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5)
lines(X,y.mbo,lwd=2)
lines(X,y.zau,lwd=2)
lines(X,y.aba,lwd=2)
points(X,tru, col="red")
points(absv,tru, col="red")
points(base$absv,base$tru, col="red")
points(base$tru, base$absv, col="red")
points(base$xtru, base$absv, col="red")
points(xtru, base$absv, col="red")
stru
xtru
points(stand(base$tru), base$absv, col="red")
stand(base$tru)
base$absv
head(base)
100*20
base
abux.sv <- tapply(base$absv, base$tra, mean)
ababux.sv
abux.sv
abux.tru <- tapply(stand(base$tru), base$tra, mean)
points(abux.sv, abux.tru, col="red")
points(abux.tru, abux.sv, col="red")
abux.tru
abux.svu
abux.sv
plot(X,y.cli,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5)
lines(X,y.cpi,lwd=2)
plot(X,y.pdo,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5)
lines(X,y.cpi,lwd=2)
lines(X,y.mmo,lwd=2)
plot(X,y.cpi,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5)
lines(X,y.pdo,lwd=2)
lines(X,y.mmo,lwd=2)
text(x=c(0.9,0.9,0.9),y=c(1.12,1.43,1.4),labels=c("Pdom","Mmon","Ppic"))
plot(X,y.cpi,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5)
lines(X,y.pdo,lwd=2)
lines(X,y.mmo,lwd=2)
lines(X,y.mmo,lwd=2)
text(x=c(0.9,0.9,0.9),y=c(1.417,1.416,1.4),labels=c("Pdom","Mmon","Ppic"))
plot(X,y.cpi,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5)
plot(X,y.cpi,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5)
lines(X,y.pdo,lwd=2)
lines(X,y.mmo,lwd=2)
text(x=c(0.9,0.9,0.7),y=c(1.413,1.415,1.417),labels=c("Pdom","Mmon","Ppic"))
plot(X,y.cpi,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5)
lines(X,y.pdo,lwd=2)
lines(X,y.mmo,lwd=2)
text(x=c(0.9,0.9,0.7),y=c(1.417,1.415,1.413),labels=c("Pdom","Mmon","Ppic"))
plot(X,y.cpi,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5, ylim=c(1.41,1.419))
lines(X,y.pdo,lwd=2)
lines(X,y.mmo,lwd=2)
text(x=c(0.9,0.9,0.7),y=c(1.417,1.416,1.413),labels=c("Pdom","Mmon","Ppic"))
plot(X,y.cpi,xlab="Relative abundance",ylab="Sturnus vulgaris \n abundance (ind/transect)",
type="l",lwd=2,cex.lab=1.5, ylim=c(1.412,1.419))
lines(X,y.pdo,lwd=2)
lines(X,y.mmo,lwd=2)
text(x=c(0.9,0.9,0.7),y=c(1.417,1.416,1.413),labels=c("Pdom","Mmon","Ppic"))
library(ggplot2)
library(mgcv)
library(itsadug)
biolum <- read.table("C:/RD/ISIT.txt", header = TRUE)
biolum$Year <- as.factor(biolum$Year)
ggplot(data = biolum, aes(x = SampleDepth, y = Sources)) +
geom_point() + facet_wrap(~Station) +
theme_bw()
ggplot(data = biolum, aes(x = SampleDepth, y = Sources)) +
geom_point() + facet_wrap(~Year) +
theme_bw()
gam0 <- gam(Sources ~ Year + s(SampleDepth), family = gaussian, data = biolum)
gamm2 <- gamm(Sources ~ Year + s(SampleDepth), random = list(Station = ~1 + SampleDepth|Station), family = gaussian, data = biolum)
plot_smooth(gamm2$gam, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
plot_parametric(gamm2$gam, pred = list(Year = levels(simdat$Year), Year = c("2001", "2002")), rm.ranef=TRUE)
plot_parametric(gamm2$gam, pred = list(Year = levels(simdat$Year), Year = "2001"), rm.ranef = TRUE)
plot_parametric(gamm2$gam, pred = list(Year = "2001"), rm.ranef = TRUE)
plot_parametric(gamm2$gam, pred = list(Station = levels(biolum$Station)), cond = list(Year = "2001"), rm.ranef = TRUE)
plot_parametric(gamm2$gam, cond = list(Station = levels(biolum$Station)), pred = list(Year = "2001"), rm.ranef = TRUE)
plot_parametric(gamm2$gam, pred = list(Year = c("2001", "2002")), rm.ranef = TRUE)
plot_smooth(gamm2$gam, view = "SampleDepth", cond = list(Year = "2001"), rm.ranef = TRUE)
?plot_smooth
class(gamm2$gam)
plot_smooth(gamm2$gam, view = "SampleDepth")
gam1 <- gam(Sources ~ Year + s(SampleDepth, bs = "re"), family = gaussian, data = biolum)
gamm1 <- gam(Sources ~ Year + s(SampleDepth, bs = "re"), family = gaussian, data = biolum)
# Intercepto y "pendiente" aleatorios
gamm2 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "re"), family = gaussian, data = biolum)
summary(gamm2)
summary(gamm2)
plot(gamm2)
gamm2 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs"), family = gaussian, data = biolum)
summary(gamm2)
plot(gamm2)
gamm2 <- gam(Sources ~ Year + s(SampleDepth, by = Station, bs = "re"), family = gaussian, data = biolum)
summary(gamm2)
gamm2 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "re"), family = gaussian, data = biolum)
summary(gamm2)
plot(gamm2)
gamm2 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs"), family = gaussian, data = biolum)
summary(gamm2)
plot(gamm2)
gam0 <- gam(Sources ~ Year + s(SampleDepth), family = gaussian, data = biolum)
# Intercepto aleatorio
gam1 <- gam(Sources ~ Year + s(SampleDepth, bs = "re"), family = gaussian, data = biolum)
# Intercepto y "pendiente" aleatorios
gamm2 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs"), family = gaussian, data = biolum)
AIC(gam0, gamm1, gamm2)
gam1 <- gam(Sources ~ Year + s(SampleDepth) + s(Station, bs = "re"), family = gaussian, data = biolum)
AIC(gam0, gamm1, gamm2)
summary(gamm2)
gamtabs(gamm2, type = "HTML")
plot_smooth(gamm2, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
plot_parametric(gamm2, pred = list(Year = c("2001", "2002")), rm.ranef = TRUE)
summary(gamm2)
head(biolum)
plot_smooth(m1, view = "SampleDepth", plot_all = "Year", Station = 1, col = "red")
plot_smooth(gamm2, view = "SampleDepth", plot_all = "Year", Station = 1, col = "red")
table(biolum$Station)
plot_smooth(gamm2, view = "SampleDepth", cond=list(Year = "2001", Station = "14"), col = "red")
# Agregar estación 15:
plot_smooth(gamm2, view = "SampleDepth", cond=list(Year = "2001", Station = "14"), col = "blue", add = TRUE)
plot_smooth(gamm2, view = "SampleDepth", cond=list(Year = "2001", Station = 14), col = "red")
plot_smooth(gamm2, view = "SampleDepth", cond=list(Year = "2001", Station = 15), col = "blue", add = TRUE)
ggplot(data = biolum, aes(x = SampleDepth, y = Sources)) +
geom_point() + facet_wrap(~Station) +
theme_bw()
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = 15), col = "red")
# Agregar estación 15:
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = 17), col = "blue", add = TRUE)
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = 3), col = "red")
# Agregar estación 15:
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = 16), col = "blue", add = TRUE)
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = 3), col = "red", xlim = c(-10, 40))
# Agregar estación 15:
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = 16), col = "blue", add = TRUE)
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = 3), col = "red", ylim = c(-10, 40))
# Agregar estación 15:
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = 16), col = "blue", add = TRUE)
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = 3), col = "red", ylim = c(-10, 60))
# Agregar estación 15:
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = 16), col = "blue", add = TRUE)
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = 3), col = "red", ylim = c(-10, 50))
# Agregar estación 15:
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = 16), col = "blue", add = TRUE)
str(biolum)
biolum$Station <- as.factor(biolum$Station)
gamm2 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs"), family = gaussian, data = biolum)
gamm2 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs"), family = gaussian, data = biolum)
AIC(gam0, gamm1, gamm2)
gam1 <- gam(Sources ~ Year + s(SampleDepth) + s(Station, bs = "re"), family = gaussian, data = biolum)
gam1 <- gam(Sources ~ Year + s(SampleDepth) + s(Station, bs = "re"), family = gaussian, data = biolum)
gam0 <- gam(Sources ~ Year + s(SampleDepth), family = gaussian, data = biolum)
AIC(gam0, gamm1, gamm2)
plot_smooth(gamm2, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
summary(gamm2)
plot_parametric(gamm2, pred = list(Year = c("2001", "2002")), rm.ranef = TRUE)
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = 3), col = "red", ylim = c(-10, 50))
head(biolum)
str(biolum)
ggplot(data = biolum, aes(x = SampleDepth, y = Sources)) +
geom_point() + facet_wrap(~Station) +
theme_bw()
ggplot(data = biolum, aes(x = SampleDepth, y = Sources)) +
geom_point() + facet_wrap(~Year) +
theme_bw()
gam0 <- gam(Sources ~ Year + s(SampleDepth), family = gaussian, data = biolum)
# Intercepto aleatorio
gam1 <- gam(Sources ~ Year + s(SampleDepth) + s(Station, bs = "re"), family = gaussian, data = biolum)
# Intercepto + pendiente aleatorios
gamm2 <- gam(Sources ~ Year + s(Station, SampleDepth, bs = "re"), family = gaussian, data = biolum)
# Intercepto + "smooth" aleatorios
gamm3 <- gam(Sources ~ Year + s(Station, SampleDepth, bs = "fs"), family = gaussian, data = biolum)
AIC(gam0, gamm1, gamm2, gamm3)
summary(gamm3)
plot_smooth(gamm2, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
gamm3 <- bam(Sources ~ Year + s(Station, SampleDepth, bs = "fs"), family = gaussian, data = biolum)
summary(gamm3)
plot_smooth(gamm2, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
gamm3 <- gam(Sources ~ s(Station, SampleDepth, bs = "fs"), family = gaussian, data = biolum)
summary(gamm3)
gamm3 <- gam(Sources ~ Year + s(Station, SampleDepth, bs = "fs", k = 10), family = gaussian, data = biolum)
gamm3 <- gam(Sources ~ Year + s(Station, SampleDepth, bs = "fs"), family = gaussian, method = "REML", data = biolum)
summary(gamm3)
gamm3 <- gam(Sources ~ s(Station, SampleDepth, bs = "fs"), family = gaussian, method = "REML", data = biolum)
summary(gamm3)
gamm3 <- gam(Sources ~ Year + s(Station, SampleDepth, bs = "fs", k = 10), family = gaussian, method = "REML", data = biolum)
summary(gamm3)
gamm3 <- gam(Sources ~ Year + s(Station, SampleDepth, bs = "fs", m = 1), family = gaussian, method = "REML", data = biolum)
summary(gamm3)
summary(gam1)
summary(gamm2)
gamm2 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "re"), family = gaussian, data = biolum)
summary(gamm2)
gamm2 <- gam(Sources ~ Year + s(Station, bs = "re") + s(SampleDepth, Station, bs = "re"), family = gaussian, data = biolum)
summary(gamm2)
gam1 <- gam(Sources ~ Year + s(SampleDepth) + s(Station, bs = "re"), family = gaussian, data = biolum)
# Intercepto + pendiente aleatorios
gamm2 <- gam(Sources ~ Year + s(Station, bs = "re") + s(SampleDepth, Station, bs = "re"), family = gaussian, data = biolum)
# Intercepto + "smooth" aleatorios
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs", m = 1), family = gaussian, method = "REML", data = biolum)
AIC(gam0, gamm1, gamm2, gamm3)
plot_smooth(gamm2, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
plot_parametric(gamm2, pred = list(Year = c("2001", "2002")), rm.ranef = TRUE)
plot_smooth(gamm2, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
summary(gamm2)
plot(gamm2)
plot_smooth(gamm1, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
plot_smooth(gamm1, view = "SampleDepth")
gam0 <- gam(Sources ~ Year + s(SampleDepth), family = gaussian, data = biolum)
biolum <- read.table("C:/RD/ISIT.txt", header = TRUE)
biolum$Station <- as.factor(biolum$Station)
biolum$Year <- as.factor(biolum$Year)
gam0 <- gam(Sources ~ Year + s(SampleDepth), family = gaussian, data = biolum)
plot(gam0)
gam1 <- gam(Sources ~ Year + s(SampleDepth) + s(Station, bs = "re"), family = gaussian, data = biolum)
plot(gam1)
gamm2 <- gam(Sources ~ Year + s(Station, bs = "re") + s(SampleDepth, Station, bs = "re"), family = gaussian, data = biolum)
plot(gamm2)
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs", m = 1), family = gaussian, method = "REML", data = biolum)
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs", m = 1), family = gaussian, method = "REML", data = biolum)
AIC(gam0, gamm1, gamm2, gamm3)
gamm1 <- gam(Sources ~ Year + s(SampleDepth) + s(Station, bs = "re"), family = gaussian, data = biolum)
AIC(gam0, gamm1, gamm2, gamm3)
summary(gamm3)
plot_smooth(gamm1, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
plot_smooth(gamm2, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
gamm2 <- gam(Sources ~ Year + s(Station, bs = "re") + s(Station, SampleDepth, bs = "re"), family = gaussian, data = biolum)
plot_smooth(gamm2, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
biolum <- read.table("C:/RD/ISIT.txt", header = TRUE)
gamm2 <- gam(Sources ~ Year + s(Station, bs = "re") + s(Station, SampleDepth, bs = "re"), family = gaussian, data = biolum)
plot_smooth(gamm2, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
biolum$Station <- as.factor(biolum$Station)
gamm2 <- gam(Sources ~ Year + s(Station, bs = "re") + s(SampleDepth, Station, bs = "re"), family = gaussian, data = biolum)
plot_smooth(gamm2, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
biolum <- read.table("C:/RD/ISIT.txt", header = TRUE)
biolum$Station <- as.factor(biolum$Station)
biolum$Year <- as.factor(biolum$Year)
gamm1 <- gam(Sources ~ Year + s(SampleDepth) + s(Station, bs = "re"), family = gaussian, data = biolum)
# Intercepto + pendiente aleatorios
gamm2 <- gam(Sources ~ Year + s(Station, bs = "re") + s(SampleDepth, Station, bs = "re"), family = gaussian, data = biolum)
# Intercepto + "smooth" aleatorios
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs", m = 1), family = gaussian, method = "REML", data = biolum)
AIC(gam0, gamm1, gamm2, gamm3)
plot_smooth(gamm1, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
plot_parametric(gamm1, pred = list(Year = c("2001", "2002")), rm.ranef = TRUE)
plot_smooth(gamm1, view = "SampleDepth", cond = list(Year = "2001", Station = 3), col = "red", ylim = c(-10, 50))
plot_smooth(gamm1, view = "SampleDepth", cond = list(Year = "2001", Station = 16), col = "blue", add = TRUE) # Agregar estación 15
plot_smooth(gamm1, view = "SampleDepth", cond = list(Year = "2001", Station = 3), col = "red", ylim = c(-10, 50))
plot_smooth(gamm1, view = "SampleDepth", cond = list(Year = "2001", Station = 16), col = "blue", add = TRUE)
str(biolum)
gam0 <- gam(Sources ~ Year + s(SampleDepth), family = gaussian, data = biolum)
plot(gam0)
# Intercepto aleatorio
gamm1 <- gam(Sources ~ Year + s(SampleDepth) + s(Station, bs = "re"), family = gaussian, data = biolum)
# Intercepto + pendiente aleatorios
gamm2 <- gam(Sources ~ Year + s(Station, bs = "re") + s(SampleDepth, Station, bs = "re"), family = gaussian, data = biolum)
# Intercepto + "smooth" aleatorios
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs", m = 1), family = gaussian, method = "REML", data = biolum)
# Comparación de estructuras de efectos aleatorios
AIC(gam0, gamm1, gamm2, gamm3)
plot_smooth(gamm1, view = "SampleDepth", cond = list(Year = "2001", Station = "3"), col = "red", ylim = c(-10, 50))
plot_smooth(gamm1, view = "SampleDepth", cond = list(Year = "2001", Station = "16"), col = "blue", add = TRUE) # Agregar estación 16
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = "3"), col = "red", ylim = c(-10, 50))
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = "16"), col = "blue", add = TRUE) # Agregar estación 16
plot_smooth(gamm3, view = "SampleDepth", cond = list(Year = "2001", Station = "3"), col = "red", ylim = c(-10, 50))
gam0 <- gam(Sources ~ Year + s(SampleDepth) + s(SampleDepth, by = Year), family = gaussian, data = biolum)
summary(gam0)
gamm1 <- gam(Sources ~ Year + s(SampleDepth) + s(SampleDepth, by = Year) + s(Station, bs = "re"), family = gaussian, data = biolum)
gam0 <- gam(Sources ~ Year + s(SampleDepth) + s(SampleDepth, by = Year), family = gaussian, data = biolum)
biolum <- read.table("C:/RD/ISIT.txt", header = TRUE)
biolum$Station <- as.factor(biolum$Station)
gam0 <- gam(Sources ~ Year + s(SampleDepth) + s(SampleDepth, by = Year), family = gaussian, data = biolum)
gamm1 <- gam(Sources ~ Year + s(SampleDepth) + s(Station, bs = "re"), family = gaussian, data = biolum)
gamm2 <- gam(Sources ~ Year +  s(SampleDepth) +
s(Station, bs = "re") + # Intercepto aleatorio
s(SampleDepth, Station, bs = "re"), # Pendiente aleatoria
family = gaussian, data = biolum)
gamm3 <- gam(Sources ~ Year + s(SampleDepth) +
s(SampleDepth, Station, bs = "fs"), # Smooth aleatorio
family = gaussian, method = "REML", data = biolum)
AIC(gam0, gamm1, gamm2, gamm3)
summary(gamm3)
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs"), # Smooth aleatorio
family = gaussian, method = "REML", data = biolum)
summary(gamm3)
summary(gamm2)
gamm3 <- gam(Sources ~ Year + s(SampleDepth, by = Year) + s(SampleDepth, Station, bs = "fs"), # Smooth aleatorio
family = gaussian, method = "REML", data = biolum)
summary(gamm3)
AIC(gam0, gamm1, gamm2)
5084.019-4914.159
plot_smooth(gamm2, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
str(biolum)
biolum$Station <- as.factor(biolum$Station)
biolum$Year <- as.factor(biolum$Year)
gam0 <- gam(Sources ~ Year + s(SampleDepth) + s(SampleDepth, by = Year), family = gaussian, data = biolum)
plot(gam0)
gamm1 <- gam(Sources ~ Year + s(SampleDepth) + s(Station, bs = "re"), family = gaussian, data = biolum)
# Intercepto + pendiente aleatorios
gamm2 <- gam(Sources ~ Year +  s(SampleDepth) +
s(Station, bs = "re") + # Intercepto aleatorio
s(SampleDepth, Station, bs = "re"), # Pendiente aleatoria
family = gaussian, data = biolum)
# Intercepto + "smooth" aleatorios
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs"), # Smooth aleatorio
family = gaussian, method = "REML", data = biolum)
summary(gamm3)
AIC(gam0, gamm1, gamm2, gamm3)
plot_smooth(gamm3, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
AIC(gam0, gamm1, gamm2)
plot_smooth(gamm2, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
plot_parametric(gamm2, pred = list(Year = c("2001", "2002")), rm.ranef = TRUE)
plot_smooth(gamm2, view = "SampleDepth", cond = list(Year = "2001", Station = "3"), col = "red", ylim = c(-10, 50))
plot_smooth(gamm1, view = "SampleDepth", cond = list(Year = "2001", Station = "16"), col = "blue", add = TRUE) # Agregar estación 16
plot(gamm1,select=3)
plot(gamm3,select=3)
check_resid(gamm2, split_by = "Station")
?check_resid
check_resid(gamm2, split_pred = "Station")
acf_resid(gamm2, split_pred = "Station")
compareML(gam0, gamm1, gamm2)
plot(gamm2)
plot(gamm2, select=2)
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs", k = 10), # Smooth aleatorio
family = gaussian, method = "REML", data = biolum)
summary(gamm3)
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs", m = 1, k = 5), # Smooth aleatorio
family = gaussian, data = biolum)
summary(gamm3)
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs", m = 1), # Smooth aleatorio
family = gaussian, data = biolum)
summary(gamm3)
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs", k = 10), # Smooth aleatorio
family = gaussian, data = biolum)
summary(gamm3)
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs", m = 1), # Smooth aleatorio
family = gaussian, data = biolum)
summary(gamm3)
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs", k = 5), # Smooth aleatorio
family = gaussian, data = biolum)
summary(gamm3)
gamm3 <- gam(Sources ~ Year + s(SampleDepth, Station, bs = "fs", m = 1, k = 5), # Smooth aleatorio
family = gaussian, data = biolum)
AIC(gam0, gamm1, gamm2, gamm3)
check_resid(gamm3, split_pred = "Station")
plot_smooth(gamm3, view = "SampleDepth", plot_all = "Year", rm.ranef = TRUE)
plot_parametric(gamm3, pred = list(Year = c("2001", "2002")), rm.ranef = TRUE)
plot_smooth(gamm3, view = "SampleDepth", cond = list(Year = "2001", Station = "3"), col = "red", ylim = c(-10, 50))
