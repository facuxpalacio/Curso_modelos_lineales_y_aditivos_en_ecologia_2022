}
plotData <- lapply(
seq(along=df$X),
function(i){
y = seq(ylim[1], ylim[2])
x = rep(X[i], length(y))
z0 = rep(0, length(y))
z = dpois(y, meanPred[i])
return(list(x=x, y=y, z0=z0, z=z))
}
)
mod <- glm(Y ~ X, family = poisson, data = df)
meanPred <- predict(mod, type="response")
sdgig <- sqrt(summary(mod)$dispersion)
UpPred <- qnorm(.95, meanPred, sdgig)
LwPred <- qnorm(.05, meanPred, sdgig)
plotData <- lapply(
seq(along=df$X),
function(i){
y = seq(ylim[1], ylim[2])
x = rep(X[i], length(y))
z0 = rep(0, length(y))
z = dpois(y, meanPred[i])
return(list(x=x, y=y, z0=z0, z=z))
}
)
glmModelPlot(x = df$X, y=df$Y,
xlim=xlim, ylim=ylim,
meanPred = meanPred, LwPred = LwPred,
UpPred = UpPred, plotData = plotData)
pois.mod <- glm(Y ~ X, family = poisson, data = df)
meanPred <- predict(pois.mod, type="response")
UpPred <- qpois(.95, meanPred)
LwPred <- qpois(.05, meanPred)
plotData <- lapply(
seq(along=df$X),
function(i){
y = seq(ylim[1], ylim[2])
x = rep(df$X[i], length(y))
z0 = rep(0, length(y))
z = dpois(y, meanPred[i])
return(list(x=x, y=y, z0=z0, z=z))
}
)
glmModelPlot(x = df$X, y=df$Y,
xlim=xlim, ylim=ylim,
meanPred = meanPred, LwPred = LwPred,
UpPred = UpPred, plotData = plotData)
glmModelPlot(x = df$X, y=df$Y,
xlim=xlim, ylim=ylim,
meanPred = meanPred, LwPred = LwPred,
UpPred = UpPred, plotData = plotData)
head(xlim)
data(iris)
head(iris)
boxplot(iris$Sepal.Length~iris$Species)
boxplot(iris$Petal.Length~iris$Petal.Width)
plot(iris$Petal.Length~iris$Petal.Width)
new<-subset(iris,Species!="setosa")
m1<-lm(Petal.Length~Petal.Width + Species, new)
summary(m1)
plot(subset(new, Species=="versicolor")$Petal.Width,
subset(new, Species=="versicolor")$Petal.Length, col="blue")
set.seed(999)
df<-data.frame(especie=sort(c(rep("1","2"),50)),
ancho.pet=rnorm(50, mean=3, sd=1))
df<-data.frame(especie=sort(c(rep("1","2"),50)),
ancho.pet=rnorm(100, mean=3, sd=1))
especie=sort(c(rep("1","2"),50))
length(especie)
df<-data.frame(especie=sort(c(rep(c("1","2"),50))),
ancho.pet=rnorm(100, mean=3, sd=1))
head(df)
df<-data.frame(especie=sort(c(rep(c(0,1),50))),
ancho.pet=rnorm(100, mean=3, sd=1))
df$long.pet<-1.76 + 0.94*df$ancho.pet + 0.2*df$especie
head(df)
df$long.pet<-1.76 + 0.94*df$ancho.pet + 1.53*df$especie +
0.2*df$ancho.pet*df$especie
spA<-subset(df,especie==0)
spB<-subset(df,especie==1)
plot(spA$ancho.pet,spA$long.pet,pch=19,col=blue)
plot(spA$ancho.pet,spA$long.pet,pch=19,col="blue")
df$long.pet<-1.76 + 0.94*df$ancho.pet + 1.53*df$especie +
0.2*df$ancho.pet*df$especie + rnorm(100)
spA<-subset(df,especie==0)
spB<-subset(df,especie==1)
plot(spA$ancho.pet,spA$long.pet,pch=19,col="blue")
point(spB$ancho.pet,spB$long.pet,pch=19,col="red")
points(spB$ancho.pet,spB$long.pet,pch=19,col="red")
0.2*df$ancho.pet*df$especie + rnorm(100,mean=0,sd=0.5)
df$long.pet<-1.76 + 0.94*df$ancho.pet + 1.53*df$especie +
0.2*df$ancho.pet*df$especie + rnorm(100,mean=0,sd=0.5)
spA<-subset(df,especie==0)
spB<-subset(df,especie==1)
plot(spA$ancho.pet,spA$long.pet,pch=19,col="blue")
points(spB$ancho.pet,spB$long.pet,pch=19,col="red")
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)" + ylab="Longitud pétalo (cm)",
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)")
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
ylim=c(3,7))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
max(spB$long.pet)
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
ylim=c(3,9))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
ylim=c(2,9))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
m1<-lm(long.pet~ancho.pet + especie, data=df)
m1<-lm(long.pet~ancho.pet + especie + ancho.pet:especie, data=df)
m1<-lm(long.pet~ancho.pet + especie, data=df)
m2<-lm(long.pet~ancho.pet + especie + ancho.pet:especie, data=df)
pred1<-predict(m1)
pred1
xA<-seq_along(spA$ancho.pet)
xA
xA<-seq_along(min(spA$ancho.pet))
xA
xA<-seq(min(spA$ancho.pet),max(spA$ancho.pet),length=50)
xB<-seq(min(spB$ancho.pet),max(spB$ancho.pet),length=50)
x<-seq(min(df$ancho.pet),max(df$ancho.pet),length=50)
predA1<-predict(m1,newdata=data.frame(ancho.pet=x,especie=0))
predA2<-predict(m1,newdata=data.frame(ancho.pet=x,especie=1))
lines(x,predA1)
lines(x,predB1)
x<-seq(min(df$ancho.pet),max(df$ancho.pet),length=50)
predA1<-predict(m1,newdata=data.frame(ancho.pet=x,especie=0))
predB1<-predict(m1,newdata=data.frame(ancho.pet=x,especie=1))
lines(x,predA1,lwd=2)
lines(x,predB1,lwd=2)
x<-seq(min(df$ancho.pet)-1,max(df$ancho.pet)+1,length=50)
predA1<-predict(m1,newdata=data.frame(ancho.pet=x,especie=0))
predB1<-predict(m1,newdata=data.frame(ancho.pet=x,especie=1))
lines(x,predA1,lwd=2)
lines(x,predB1,lwd=2)
summary(m1)
df$long.pet<-1.76 + 0.94*df$ancho.pet + 1.53*df$especie +
0.4*df$ancho.pet*df$especie + rnorm(100,mean=0,sd=0.5)
spA<-subset(df,especie==0)
spB<-subset(df,especie==1)
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
ylim=c(2,9))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
df$long.pet<-1.76 + 0.94*df$ancho.pet + 1.53*df$especie -
0.4*df$ancho.pet*df$especie + rnorm(100,mean=0,sd=0.5)
spA<-subset(df,especie==0)
spB<-subset(df,especie==1)
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
ylim=c(2,9))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
df$long.pet<-1.76 + 0.94*df$ancho.pet + 1.53*df$especie +
0.8*df$ancho.pet*df$especie + rnorm(100,mean=0,sd=0.5)
spA<-subset(df,especie==0)
spB<-subset(df,especie==1)
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
ylim=c(2,9))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
ylim=c(min(df$long.pet),max(df$long.pet)))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
m1<-lm(long.pet~ancho.pet + especie, data=df)
m2<-lm(long.pet~ancho.pet + especie + ancho.pet:especie, data=df)
summary(m1)
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
xlim(c(min$df$ancho.pet),max(df$ancho.pet))
ylim=c(min(df$long.pet),max(df$long.pet)))
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
xlim(c(min$df$ancho.pet),max(df$ancho.pet)),
ylim=c(min(df$long.pet),max(df$long.pet)))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
xlim=c(min(df$ancho.pet),max(df$ancho.pet)),
ylim=c(min(df$long.pet),max(df$long.pet)))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
m1<-lm(long.pet~ancho.pet + especie, data=df)
m2<-lm(long.pet~ancho.pet + especie + ancho.pet:especie, data=df)
summary(m1)
x<-seq(min(df$ancho.pet)-1,max(df$ancho.pet)+1,length=50)
predA1<-predict(m1,newdata=data.frame(ancho.pet=x,especie=0))
predB1<-predict(m1,newdata=data.frame(ancho.pet=x,especie=1))
lines(x,predA1,lwd=2)
lines(x,predB1,lwd=2)
3.81+1.76
summary(m2)
x<-seq(min(df$ancho.pet)-1,max(df$ancho.pet)+1,length=50)
predA2<-predict(m2,newdata=data.frame(ancho.pet=x,especie=0))
predB2<-predict(m2,newdata=data.frame(ancho.pet=x,especie=1))
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
xlim=c(min(df$ancho.pet),max(df$ancho.pet)),
ylim=c(min(df$long.pet),max(df$long.pet)))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
lines(x,predA2,lwd=2)
lines(x,predB2,lwd=2)
summary(m2)
summary(m2)
1.96+0.23
0.63+3.81
x<-seq(0,max(df$ancho.pet)+1,length=50)
predA1<-predict(m1,newdata=data.frame(ancho.pet=x,especie=0))
predB1<-predict(m1,newdata=data.frame(ancho.pet=x,especie=1))
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
xlim=c(0,max(df$ancho.pet)),
ylim=c(min(df$long.pet),max(df$long.pet)))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
lines(x,predA1,lwd=2)
lines(x,predB1,lwd=2)
x<-seq(-1,max(df$ancho.pet)+1,length=50)
predA1<-predict(m1,newdata=data.frame(ancho.pet=x,especie=0))
predB1<-predict(m1,newdata=data.frame(ancho.pet=x,especie=1))
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
xlim=c(0,max(df$ancho.pet)),
ylim=c(0,max(df$long.pet)))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
lines(x,predA1,lwd=2)
lines(x,predB1,lwd=2)
abline(v=0,lty=2)
x<-seq(-1,max(df$ancho.pet)+1,length=50)
predA1<-predict(m1,newdata=data.frame(ancho.pet=x,especie=0))
predB1<-predict(m1,newdata=data.frame(ancho.pet=x,especie=1))
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
xlim=c(0.2,max(df$ancho.pet)),
ylim=c(0.2,max(df$long.pet)))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
lines(x,predA1,lwd=2)
lines(x,predB1,lwd=2)
abline(v=0,lty=2)
x<-seq(-1,max(df$ancho.pet)+1,length=50)
predA2<-predict(m2,newdata=data.frame(ancho.pet=x,especie=0))
predB2<-predict(m2,newdata=data.frame(ancho.pet=x,especie=1))
predA2<-predict(m2,newdata=data.frame(ancho.pet=x,especie=0))
predB2<-predict(m2,newdata=data.frame(ancho.pet=x,especie=1))
plot(spA$ancho.pet,spA$long.pet,pch=19,cex=1.5,col="blue",
xlab="Ancho pétalo (cm)", ylab="Longitud pétalo (cm)",
xlim=c(0.2,max(df$ancho.pet)),
ylim=c(0.2,max(df$long.pet)))
points(spB$ancho.pet,spB$long.pet,pch=19,cex=1.5,col="red")
lines(x,predA2,lwd=2)
lines(x,predB2,lwd=2)
summary(m2)
1.96+1.23
0.91+0.89
summary8m1
summary(m1)
library(glmmTMB)
library(MuMIn)
options(na.action = "na.fail")
library(psych)
polis<-read.table("C:/RD/visitaspoli3.txt",head=T,dec=",")
polis$parche<-as.factor(polis$parche)
polis$diam<-as.numeric(polis$diam)
polis$area<-as.numeric(polis$area)
polis$long.planta<-as.numeric(polis$long.planta)
polis$pcapxarea<-as.numeric(polis$pcapxarea)
polis2<-polis[,c(1:16,20)]
polis3<-na.omit(polis2)
levels(polis3$trat)
polis3$trat<-relevel(polis3$trat,ref=3)
polis<-read.table("C:/RD/visitaspoli3.txt",head=T,dec=",")
polis$parche<-as.factor(polis$parche)
polis$diam<-as.numeric(polis$diam)
polis$area<-as.numeric(polis$area)
polis$long.planta<-as.numeric(polis$long.planta)
polis$pcapxarea<-as.numeric(polis$pcapxarea)
polis2<-polis[,c(1:16,20)]
polis3<-na.omit(polis2)
head(polis3)
m2<-glmmTMB(n.visitas ~ trat + fecha + trat:fecha + pcapxarea + capxpl +
(1|parche), family=poisson, data=polis3)
summary(m2)
cor(polis3[,c("area","long.planta","capxpl","pcapxarea")])
dredge.m2<-dredge(m2,rank="AICc")
dredge.m2
hist(polis3$n.visitas)
m3<-glmmTMB(n.visitas ~ trat + fecha + trat:fecha + pcapxarea + capxpl +
(1|parche), family=nb, data=polis3)
m3<-glmmTMB(n.visitas ~ trat + fecha + trat:fecha + pcapxarea + capxpl +
(1|parche), family=neg.bin, data=polis3)
m3<-glmmTMB(n.visitas ~ trat + fecha + trat:fecha + pcapxarea + capxpl +
(1|parche), family=nbinom1, data=polis3)
AIC(m2,m3)
m3<-glmmTMB(n.visitas ~ trat + fecha + trat:fecha + pcapxarea + capxpl +
(1|parche), family=nbinom2, data=polis3)
AIC(m2,m3)
hist(polis3$cap.visit)
m2d<-glmmTMB(cap.visit ~ trat + fecha + trat:fecha + pcapxarea + capxpl +
(1|parche), family=negbinom1, data=polis3)
m2d<-glmmTMB(cap.visit ~ trat + fecha + trat:fecha + pcapxarea + capxpl +
(1|parche), family=negbin1, data=polis3)
m2d<-glmmTMB(cap.visit ~ trat + fecha + trat:fecha + pcapxarea + capxpl +
(1|parche), family=nbinom1, data=polis3)
m2c<-glmmTMB(cap.visit ~ trat + fecha + trat:fecha + pcapxarea + capxpl +
(1|parche), family=poisson, data=polis3)
m2d<-glmmTMB(cap.visit ~ trat + fecha + trat:fecha + pcapxarea + capxpl +
(1|parche), family=nbinom1, data=polis3)
AIC(m2c,m2d)
avg.m2c<-model.avg(dredge.m2c, subset = delta < 2)
dredge.m2c<-dredge(m2c,rank="AICc")
dredge.m2c
base.completa<-read.table("C:/RD/orden.completa.txt",head=T,dec=",")
base.completa<-read.table("C:/RD/orden.completa2.txt",head=T,dec=",")
base.completa$long.planta<-as.numeric(base.completa$long.planta)
base.completa2<-na.omit(base.completa)
table(base.completa$orden)
base.completa2$id.parche<-as.factor(base.completa2$id.parche)
base.completa2$area<-as.numeric(base.completa2$area)
hist(base.completa$n.visitas)
hist(base.completa$capvisit)
m5<-glmmTMB(capvisit ~ trat + fecha + orden + trat:fecha + trat:orden + pcapxarea + capxpl +
m6<-glmmTMB(capvisit ~ trat + fecha + orden + trat:fecha + trat:orden + pcapxarea + capxpl +
(1|id.parche), family=nbinom1, data=base.completa2)
head(base.completa2)
df<-read.table("C:/RD/verbeseed2.txt",head=T,dec=",")
levels(df$clausura)
levels(df$clausura)[levels(df$clausura)=="embolsado"]<-"clausura"
levels(df$clausura)
#Resumenes
capN<-with(df,tapply(id.plant,list(clausura),length))
capN
N2<-with(df,tapply(n.cap,list(morfo.sem2,clausura),length))
N2
ce<-ce<-(ms[1]*mc[1])/np[1]
ms<-with(df,tapply(n.semillas,list(morfo.sem2,clausura),mean))
ce<-ce<-(ms[1]*mc[1])/np[1]
plot(m3)
plot(m2)
library(piecewiseSEM)
library(MASS)
plants <- read.table("C:/RD/Data Passiflora AOS_2020_plants.txt", head=T)
f_urb <- factor(plants$idpopulation,
levels = c("La_Plata", "Magdalena", "Ranchos"),
labels = c("3", "1", "2"))
plants$urb_level <- as.numeric(levels(f_urb)[f_urb])
plants$urb_level2 <- plants$urb_level^2
plants <- na.omit(plants[, c(7:8, 11, 13, 17, 20:22)])
#### Raw estimates assuming different error distributions
## M1. Influence of urbanization on bird visitation
M1 <- psem(
# Influence of urbanization on fruit traits
glm.nb(crop ~ urb_level + urb_level2, data = plants),
lm(x.diam ~ urb_level + urb_level2, data = plants),
lm(x.nseeds ~ urb_level + urb_level2, data = plants),
lm(x.peel.sugar ~ urb_level + urb_level2 + crop, data = plants),
# Fruit traits and fitness
glm(visits ~ urb_level + urb_level2 + crop + x.diam + x.nseeds + x.peel.sugar,
family = poisson, data = plants),
# Correlation between fitness measures
fruit_rem %~~% visits,
# Fruit trait correlations
x.nseeds %~~% x.diam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
resM1 <- summary(M1, direction = c("x.nseeds <- crop"))
# M2. Influence of urbanization on fruit removal
M2 <- psem(
# Influence of urbanization on fruit traits
glm.nb(crop ~ urb_level + urb_level2, data = plants),
lm(x.diam ~ urb_level + urb_level2, data = plants),
lm(x.nseeds ~ urb_level + urb_level2, data = plants),
lm(x.peel.sugar ~ urb_level + urb_level2 + crop, data = plants),
# Fruit traits and fitness
glm(visits ~ urb_level + urb_level2 + crop + x.diam + x.nseeds + x.peel.sugar,
family = poisson, data = plants),
# New paths: influence of fruit traits and urbanization on fruit removal
glm.nb(fruit_rem ~ urb_level + urb_level2 + crop + x.diam + x.nseeds + x.peel.sugar,
data = plants),
# Correlation between fitness measures
fruit_rem %~~% visits,
# Fruit trait correlations
x.nseeds %~~% x.diam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
resM2 <- summary(M2, direction = c("x.nseeds <- crop"))
# M3. Urbanization has an interactive effect with fruit traits on selection
M3 <- psem(
# Influence of urbanization on fruit traits
glm.nb(crop ~ urb_level + urb_level2, data = plants),
lm(x.diam ~ urb_level + urb_level2 , data = plants),
lm(x.nseeds ~ urb_level + urb_level2, data = plants),
lm(x.peel.sugar ~ urb_level + urb_level2 + crop, data = plants),
# New paths: Fruit traits and fitness interaction with urbanization
glm(visits ~ urb_level*crop + urb_level*x.diam + urb_level*x.nseeds +
urb_level*x.peel.sugar, family = poisson,
data = plants),
# Correlation between fitness measures
fruit_rem %~~% visits,
# Fruit trait correlations
x.nseeds %~~% x.diam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
resM3 <- summary(M3, direction = c("x.nseeds <- crop"))
# M4. Visits are influenced by fruit traits rather than by urbanization,
# fruit removal is not influenced by urbanization
M4 <- psem(
# Influence of urbanization on fruit traits
glm.nb(crop ~ urb_level + urb_level2, data = plants),
lm(x.diam ~ urb_level + urb_level2, data = plants),
lm(x.nseeds ~ urb_level + urb_level2, data = plants),
lm(x.peel.sugar ~ urb_level + urb_level2 + crop, data = plants),
# Fruit traits and fitness
glm(visits ~ crop + x.diam + x.nseeds + x.peel.sugar,
family = poisson, data = plants),
# Correlation between fitness measures
fruit_rem %~~% visits,
# Fruit trait correlations
x.nseeds %~~% x.diam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
resM4 <- summary(M4, direction = c("x.nseeds <- crop"))
resM1$IC
resM2$IC
resM3$IC
resM4$IC
resM1$Cstat
resM2$Cstat
resM3$Cstat
resM4$Cstat
write.csv(coefs(M4),"coefs_M4.csv")
write.csv(resM4$dTable,"dTable_M4.csv")
write.csv(resM4$Cstat,"Cstat_M4.csv")
write.csv(resM4$IC,"IC_M4.csv")
write.csv(resM4$R2,"R2_M4.csv")
resM4
# M4. Visits are influenced by fruit traits rather than by urbanization,
# fruit removal is not influenced by urbanization
M4 <- psem(
# Influence of urbanization on fruit traits
lm(zcrop ~ urb_level + urb_level2, data = zdata),
lm(zdiam ~ urb_level + urb_level2 + zcrop, data = zdata),
lm(znseeds ~ urb_level + urb_level2 + zcrop, data = zdata),
lm(zpeel.sugar ~ urb_level + urb_level2 + zcrop, data = zdata),
# Fruit traits and fitness
lm(wvisits ~ zcrop + zdiam + znseeds + zpeel.sugar, data = zdata),
# Correlation between fitness measures
wfruit_rem %~~% wvisits,
# Fruit trait correlations
znseeds %~~% zdiam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
zdata <- na.omit(data.frame(urb_level = plants$urb_level,
urb_level2 = plants$urb_level2,
zcrop = scale(plants$crop),
zdiam = scale(plants$x.diam),
znseeds = scale(plants$x.nseeds),
zpeel.sugar = scale(plants$x.peel.sugar),
wvisits = plants$visits/mean(plants$fruit_rem),
wfruit_rem = plants$fruit_rem/mean(plants$fruit_rem)))
# M4. Visits are influenced by fruit traits rather than by urbanization,
# fruit removal is not influenced by urbanization
M4 <- psem(
# Influence of urbanization on fruit traits
lm(zcrop ~ urb_level + urb_level2, data = zdata),
lm(zdiam ~ urb_level + urb_level2 + zcrop, data = zdata),
lm(znseeds ~ urb_level + urb_level2 + zcrop, data = zdata),
lm(zpeel.sugar ~ urb_level + urb_level2 + zcrop, data = zdata),
# Fruit traits and fitness
lm(wvisits ~ zcrop + zdiam + znseeds + zpeel.sugar, data = zdata),
# Correlation between fitness measures
wfruit_rem %~~% wvisits,
# Fruit trait correlations
znseeds %~~% zdiam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
resM4 <- summary(M4)
resM4$coefficients
resM4$coefficients
write.csv(resM4$coefficients$Std.Estimate, "zcoeff.M4.csv")
resM4$coefficients
write.csv(resM4$coefficients, "zcoeff.M4.csv")
# M4. Visits are influenced by fruit traits rather than by urbanization,
# fruit removal is not influenced by urbanization
M4 <- psem(
# Influence of urbanization on fruit traits
lm(zcrop ~ urb_level + urb_level2, data = zdata),
lm(zdiam ~ urb_level + urb_level2, data = zdata),
lm(znseeds ~ urb_level + urb_level2, data = zdata),
lm(zpeel.sugar ~ urb_level + urb_level2 + zcrop, data = zdata),
# Fruit traits and fitness
lm(wvisits ~ zcrop + zdiam + znseeds + zpeel.sugar, data = zdata),
# Correlation between fitness measures
wfruit_rem %~~% wvisits,
# Fruit trait correlations
znseeds %~~% zdiam,
# Urbanization term correlations
urb_level2 %~~% urb_level
)
resM4 <- summary(M4)
setwd("C:/Users/54221/Dropbox/Publicaciones/Passiflora y urbanización/Resultados")
write.csv(resM4$coefficients, "zcoeff.M4.csv")
citation()
