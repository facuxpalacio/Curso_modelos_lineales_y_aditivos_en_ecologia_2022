<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Modelos no lineales | Modelos lineales y aditivos en ecología</title>
  <meta name="description" content="Scripts del curso" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Modelos no lineales | Modelos lineales y aditivos en ecología" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Scripts del curso" />
  <meta name="github-repo" content="facuxpalacio/Curso_modelos_lineales_y_aditivos_en_ecologia_2022/bookdown_curso" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Modelos no lineales | Modelos lineales y aditivos en ecología" />
  
  <meta name="twitter:description" content="Scripts del curso" />
  

<meta name="author" content="Facundo X. Palacio" />


<meta name="date" content="2022-04-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelos-lineales-generalizados.html"/>

<script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html"><i class="fa fa-check"></i><b>1</b> IntroducciÃ³n a los modelos lineales<span></span></a><ul>
<li class="chapter" data-level="1.1" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#definiciã³n-de-modelo-lineal"><i class="fa fa-check"></i><b>1.1</b> DefiniciÃ³n de modelo lineal<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#correlaciã³n-lineal-simple"><i class="fa fa-check"></i><b>1.2</b> CorrelaciÃ³n lineal simple<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#matrices-de-correlaciã³n"><i class="fa fa-check"></i><b>1.3</b> Matrices de correlaciÃ³n<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#regresiã³n-lineal-simple"><i class="fa fa-check"></i><b>1.4</b> RegresiÃ³n lineal simple<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#relaciã³n-entre-regresiã³n-y-correlaciã³n"><i class="fa fa-check"></i><b>1.5</b> RelaciÃ³n entre regresiÃ³n y correlaciÃ³n<span></span></a></li>
<li class="chapter" data-level="1.6" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#matrices-de-grãficos-de-dispersiã³n"><i class="fa fa-check"></i><b>1.6</b> Matrices de grÃ¡ficos de dispersiÃ³n<span></span></a></li>
<li class="chapter" data-level="1.7" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#regresiã³n-lineal-multiple"><i class="fa fa-check"></i><b>1.7</b> RegresiÃ³n lineal multiple<span></span></a></li>
<li class="chapter" data-level="1.8" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#variables-categã³ricas-dummies"><i class="fa fa-check"></i><b>1.8</b> Variables categÃ³ricas (= <em>dummies</em>)<span></span></a></li>
<li class="chapter" data-level="1.9" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#test-de-t"><i class="fa fa-check"></i><b>1.9</b> Test de <em>t</em><span></span></a></li>
<li class="chapter" data-level="1.10" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#test-de-t-pareado"><i class="fa fa-check"></i><b>1.10</b> Test de <em>t</em> pareado<span></span></a></li>
<li class="chapter" data-level="1.11" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#anãlisis-de-la-varianza"><i class="fa fa-check"></i><b>1.11</b> AnÃ¡lisis de la varianza<span></span></a></li>
<li class="chapter" data-level="1.12" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#supuestos"><i class="fa fa-check"></i><b>1.12</b> Supuestos<span></span></a><ul>
<li class="chapter" data-level="1.12.1" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#colinealidad"><i class="fa fa-check"></i><b>1.12.1</b> Colinealidad<span></span></a></li>
<li class="chapter" data-level="1.12.2" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#anãlisis-de-residuos"><i class="fa fa-check"></i><b>1.12.2</b> AnÃ¡lisis de residuos<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.13" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#transformaciones"><i class="fa fa-check"></i><b>1.13</b> Transformaciones<span></span></a></li>
<li class="chapter" data-level="1.14" data-path="introducciã³n-a-los-modelos-lineales.html"><a href="introducciã³n-a-los-modelos-lineales.html#actividades"><i class="fa fa-check"></i><b>1.14</b> Actividades<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html"><i class="fa fa-check"></i><b>2</b> Modelos lineales generalizados<span></span></a><ul>
<li class="chapter" data-level="2.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#datos-de-presencia-ausencia"><i class="fa fa-check"></i><b>2.1</b> Datos de presencia-ausencia<span></span></a><ul>
<li class="chapter" data-level="2.1.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#glm-binomial"><i class="fa fa-check"></i><b>2.1.1</b> GLM binomial<span></span></a></li>
<li class="chapter" data-level="2.1.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#bondad-del-ajuste"><i class="fa fa-check"></i><b>2.1.2</b> Bondad del ajuste<span></span></a></li>
<li class="chapter" data-level="2.1.3" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#grãâãâãâãâfico-del-modelo"><i class="fa fa-check"></i><b>2.1.3</b> GrÃÂÃÂÃÂÃÂ¡fico del modelo<span></span></a></li>
<li class="chapter" data-level="2.1.4" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#interpretaciãâãâãâãâ³n-de-los-coeficientes"><i class="fa fa-check"></i><b>2.1.4</b> InterpretaciÃÂÃÂÃÂÃÂ³n de los coeficientes<span></span></a></li>
<li class="chapter" data-level="2.1.5" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#validaciãâãâãâãâ³n"><i class="fa fa-check"></i><b>2.1.5</b> ValidaciÃÂÃÂÃÂÃÂ³n<span></span></a></li>
<li class="chapter" data-level="2.1.6" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ecuaciãâãâãâãâ³n"><i class="fa fa-check"></i><b>2.1.6</b> EcuaciÃÂÃÂÃÂÃÂ³n<span></span></a></li>
<li class="chapter" data-level="2.1.7" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#capacidad-predictiva"><i class="fa fa-check"></i><b>2.1.7</b> Capacidad predictiva<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#conteos-i"><i class="fa fa-check"></i><b>2.2</b> Conteos I<span></span></a><ul>
<li class="chapter" data-level="2.2.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#glms-poisson-y-quasi-poisson"><i class="fa fa-check"></i><b>2.2.1</b> GLMs Poisson y quasi-Poisson<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#glm-binomial-negativo"><i class="fa fa-check"></i><b>2.2.2</b> GLM binomial negativo<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#modelo-lineal-general"><i class="fa fa-check"></i><b>2.3</b> Modelo lineal general<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#glm-gamma"><i class="fa fa-check"></i><b>2.4</b> GLM Gamma<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#actividades-1"><i class="fa fa-check"></i><b>2.5</b> Actividades<span></span></a><ul>
<li class="chapter" data-level="2.5.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejercicio-2.1"><i class="fa fa-check"></i><b>2.5.1</b> Ejercicio 2.1<span></span></a></li>
<li class="chapter" data-level="2.5.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejercicio-2.2"><i class="fa fa-check"></i><b>2.5.2</b> Ejercicio 2.2<span></span></a></li>
<li class="chapter" data-level="2.5.3" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejercicio-2.3"><i class="fa fa-check"></i><b>2.5.3</b> Ejercicio 2.3<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#conteos-ii"><i class="fa fa-check"></i><b>2.6</b> Conteos II<span></span></a><ul>
<li class="chapter" data-level="2.6.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#modelos-truncados-en-cero"><i class="fa fa-check"></i><b>2.6.1</b> Modelos truncados en cero<span></span></a></li>
<li class="chapter" data-level="2.6.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#modelos-inflados-en-ceros"><i class="fa fa-check"></i><b>2.6.2</b> Modelos inflados en ceros<span></span></a></li>
<li class="chapter" data-level="2.6.3" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#interpretaciãâãâãâãâãâãâãâãâ³n-y-grãâãâãâãâãâãâãâãâficos-del-modelo-1"><i class="fa fa-check"></i><b>2.6.3</b> InterpretaciÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ³n y grÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ¡ficos del modelo<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#inferencia-multimodelo"><i class="fa fa-check"></i><b>2.7</b> Inferencia multimodelo<span></span></a><ul>
<li class="chapter" data-level="2.7.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#selecciãâãâãâãâãâãâãâãâ³n-de-modelos"><i class="fa fa-check"></i><b>2.7.1</b> SelecciÃÂÃÂÃÂÃÂÃÂÃÂÃÂÃÂ³n de modelos<span></span></a></li>
<li class="chapter" data-level="2.7.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#promediado-de-modelos"><i class="fa fa-check"></i><b>2.7.2</b> Promediado de modelos<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#actividades-2"><i class="fa fa-check"></i><b>2.8</b> Actividades<span></span></a><ul>
<li class="chapter" data-level="2.8.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejercicio-3.1---selecciãâ³n-de-modelos"><i class="fa fa-check"></i><b>2.8.1</b> Ejercicio 3.1 - SelecciÃÂ³n de modelos<span></span></a></li>
<li class="chapter" data-level="2.8.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejercicio-3.2"><i class="fa fa-check"></i><b>2.8.2</b> Ejercicio 3.2<span></span></a></li>
<li class="chapter" data-level="2.8.3" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejercicio-3.3"><i class="fa fa-check"></i><b>2.8.3</b> Ejercicio 3.3<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html"><i class="fa fa-check"></i><b>3</b> Modelos no lineales<span></span></a><ul>
<li class="chapter" data-level="3.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#regresiãâ³n-no-paramãâtrica"><i class="fa fa-check"></i><b>3.1</b> RegresiÃÂ³n no paramÃÂ©trica<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#regresiãâ³n-polinãâ³mica"><i class="fa fa-check"></i><b>3.2</b> RegresiÃÂ³n polinÃÂ³mica<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#funciones-a-trozos"><i class="fa fa-check"></i><b>3.3</b> Funciones a trozos<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#splines-de-regresiãâ³n"><i class="fa fa-check"></i><b>3.4</b> Splines de regresiÃÂ³n<span></span></a><ul>
<li class="chapter" data-level="3.4.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#polinomios-a-trozos"><i class="fa fa-check"></i><b>3.4.1</b> Polinomios a trozos<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#splines-de-suavizado"><i class="fa fa-check"></i><b>3.5</b> Splines de suavizado<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#modelos-aditivos-generalizados"><i class="fa fa-check"></i><b>3.6</b> Modelos aditivos generalizados<span></span></a><ul>
<li class="chapter" data-level="3.6.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#gam-con-otras-distribuciones-e-interacciones"><i class="fa fa-check"></i><b>3.6.1</b> GAM con otras distribuciones e interacciones<span></span></a></li>
<li class="chapter" data-level="3.6.2" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#comparaciãâ³n-de-modelos"><i class="fa fa-check"></i><b>3.6.2</b> ComparaciÃÂ³n de modelos<span></span></a></li>
<li class="chapter" data-level="3.6.3" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#validaciãâ³n"><i class="fa fa-check"></i><b>3.6.3</b> ValidaciÃÂ³n<span></span></a></li>
<li class="chapter" data-level="3.6.4" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#modelo-con-variables-continuas-efectos-principales-interacciones"><i class="fa fa-check"></i><b>3.6.4</b> Modelo con variables continuas (efectos principales + interacciones)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#actividades-3"><i class="fa fa-check"></i><b>3.7</b> Actividades<span></span></a><ul>
<li class="chapter" data-level="3.7.1" data-path="modelos-no-lineales.html"><a href="modelos-no-lineales.html#ejercicio-4.2"><i class="fa fa-check"></i><b>3.7.1</b> Ejercicio 4.2<span></span></a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos lineales y aditivos en ecología</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-no-lineales" class="section level1 hasAnchor">
<h1><span class="header-section-number">3</span> Modelos no lineales<a href="modelos-no-lineales.html#modelos-no-lineales" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="regresiãâ³n-no-paramãâtrica" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.1</span> RegresiÃÂ³n no paramÃÂ©trica<a href="modelos-no-lineales.html#regresiãâ³n-no-paramãâtrica" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Se tomaron medidas del peso seco (peso.seco) y del largo (largo) de una especie de almeja (almejas.txt). Analizar la relaciÃÂ³n entre el largo y el peso seco.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="modelos-no-lineales.html#cb1-1"></a>almejas &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;C:/RD/almejas.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-2"><a href="modelos-no-lineales.html#cb1-2"></a><span class="kw">str</span>(almejas)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    398 obs. of  3 variables:
##  $ mes      : int  11 11 11 11 11 11 11 11 11 11 ...
##  $ largo    : num  28.4 16.6 13.7 17.4 11.8 ...
##  $ peso.seco: num  0.248 0.052 0.028 0.07 0.022 0.187 0.361 0.05 0.087 0.128 ...</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="modelos-no-lineales.html#cb3-1"></a><span class="co"># opciÃÂ³n 1</span></span>
<span id="cb3-2"><a href="modelos-no-lineales.html#cb3-2"></a><span class="kw">plot</span>(almejas<span class="op">$</span>largo, almejas<span class="op">$</span>peso.seco, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">xlab =</span> <span class="st">&quot;Largo&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Peso&quot;</span>)</span>
<span id="cb3-3"><a href="modelos-no-lineales.html#cb3-3"></a>loess.model &lt;-<span class="st"> </span><span class="kw">loess</span>(peso.seco <span class="op">~</span><span class="st"> </span>largo, <span class="dt">data =</span> almejas)</span>
<span id="cb3-4"><a href="modelos-no-lineales.html#cb3-4"></a>largo &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(almejas<span class="op">$</span>largo), <span class="kw">max</span>(almejas<span class="op">$</span>largo), <span class="dt">length =</span> <span class="dv">500</span>)</span>
<span id="cb3-5"><a href="modelos-no-lineales.html#cb3-5"></a>predPeso &lt;-<span class="st"> </span><span class="kw">predict</span>(loess.model, <span class="dt">newdata =</span> <span class="kw">data.frame</span>(largo))</span>
<span id="cb3-6"><a href="modelos-no-lineales.html#cb3-6"></a><span class="kw">lines</span>(largo, predPeso, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/loess-1.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="modelos-no-lineales.html#cb4-1"></a><span class="co"># opciÃÂ³n 2</span></span>
<span id="cb4-2"><a href="modelos-no-lineales.html#cb4-2"></a><span class="kw">library</span>(car)</span></code></pre></div>
<pre><code>## Loading required package: carData</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="modelos-no-lineales.html#cb6-1"></a><span class="kw">scatterplot</span>(peso.seco <span class="op">~</span><span class="st"> </span>largo, <span class="dt">data =</span> almejas, <span class="dt">regLine =</span> <span class="ot">FALSE</span>, <span class="dt">smooth =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/loess-2.png" width="672" /></p>
</div>
<div id="regresiãâ³n-polinãâ³mica" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.2</span> RegresiÃÂ³n polinÃÂ³mica<a href="modelos-no-lineales.html#regresiãâ³n-polinãâ³mica" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="modelos-no-lineales.html#cb7-1"></a><span class="co"># Simulamos dos variables</span></span>
<span id="cb7-2"><a href="modelos-no-lineales.html#cb7-2"></a><span class="kw">set.seed</span>(<span class="dv">99</span>)</span>
<span id="cb7-3"><a href="modelos-no-lineales.html#cb7-3"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">500</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb7-4"><a href="modelos-no-lineales.html#cb7-4"></a>y &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="fl">0.2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">500</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb7-5"><a href="modelos-no-lineales.html#cb7-5"></a><span class="kw">plot</span>(x, y)</span></code></pre></div>
<p><img src="_main_files/figure-html/reg%20polinomica-1.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="modelos-no-lineales.html#cb8-1"></a><span class="co"># Ajuste del modelo</span></span>
<span id="cb8-2"><a href="modelos-no-lineales.html#cb8-2"></a>reg.pol &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</span>
<span id="cb8-3"><a href="modelos-no-lineales.html#cb8-3"></a><span class="kw">anova</span>(reg.pol)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: y
##            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## x           1 2270.96 2270.96  544.00 &lt; 2.2e-16 ***
## I(x^2)      1   86.04   86.04   20.61 7.076e-06 ***
## I(x^3)      1 2123.63 2123.63  508.70 &lt; 2.2e-16 ***
## Residuals 496 2070.59    4.17                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="modelos-no-lineales.html#cb10-1"></a><span class="kw">summary</span>(reg.pol)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2) + I(x^3))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.3763 -1.3071 -0.1047  1.5228  6.9486 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.08920    0.11498  18.171  &lt; 2e-16 ***
## x           -0.67260    0.15063  -4.465 9.91e-06 ***
## I(x^2)       0.12711    0.06716   1.893    0.059 .  
## I(x^3)       0.93229    0.04134  22.554  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.043 on 496 degrees of freedom
## Multiple R-squared:  0.6839, Adjusted R-squared:  0.682 
## F-statistic: 357.8 on 3 and 496 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="funciones-a-trozos" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.3</span> Funciones a trozos<a href="modelos-no-lineales.html#funciones-a-trozos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="modelos-no-lineales.html#cb12-1"></a>x.categorica &lt;-<span class="st"> </span><span class="kw">cut</span>(x, <span class="dt">breaks =</span> <span class="dv">10</span>) <span class="co"># Dividimos la variable en 10 intervalos</span></span>
<span id="cb12-2"><a href="modelos-no-lineales.html#cb12-2"></a>fun.trozos &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x.categorica)</span>
<span id="cb12-3"><a href="modelos-no-lineales.html#cb12-3"></a><span class="kw">summary</span>(fun.trozos)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x.categorica)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.1982 -1.3038 -0.1617  1.4424 10.5097 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                 -16.1963     0.9759  -16.60   &lt;2e-16 ***
## x.categorica(-2.49,-1.93]    10.9342     1.1770    9.29   &lt;2e-16 ***
## x.categorica(-1.93,-1.37]    15.8749     1.0567   15.02   &lt;2e-16 ***
## x.categorica(-1.37,-0.809]   17.6050     1.0112   17.41   &lt;2e-16 ***
## x.categorica(-0.809,-0.247]  18.3686     0.9987   18.39   &lt;2e-16 ***
## x.categorica(-0.247,0.314]   18.7227     0.9993   18.73   &lt;2e-16 ***
## x.categorica(0.314,0.876]    18.1608     1.0046   18.08   &lt;2e-16 ***
## x.categorica(0.876,1.44]     18.8814     1.0193   18.52   &lt;2e-16 ***
## x.categorica(1.44,2]         21.3350     1.0656   20.02   &lt;2e-16 ***
## x.categorica(2,2.57]         28.9138     1.1484   25.18   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.182 on 490 degrees of freedom
## Multiple R-squared:  0.6438, Adjusted R-squared:  0.6373 
## F-statistic: 98.41 on 9 and 490 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="modelos-no-lineales.html#cb14-1"></a>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(fun.trozos)</span>
<span id="cb14-2"><a href="modelos-no-lineales.html#cb14-2"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, x.categorica, y, pred)</span>
<span id="cb14-3"><a href="modelos-no-lineales.html#cb14-3"></a></span>
<span id="cb14-4"><a href="modelos-no-lineales.html#cb14-4"></a><span class="co"># Sin lÃÂ­neas verticales</span></span>
<span id="cb14-5"><a href="modelos-no-lineales.html#cb14-5"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.0.5</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="modelos-no-lineales.html#cb16-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df, <span class="kw">aes</span>(x, pred, <span class="dt">group =</span> x.categorica)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-2"><a href="modelos-no-lineales.html#cb16-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb16-3"><a href="modelos-no-lineales.html#cb16-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> df, <span class="kw">aes</span>(x, y))</span></code></pre></div>
<p><img src="_main_files/figure-html/funciones%20a%20trozos-1.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="modelos-no-lineales.html#cb17-1"></a><span class="co"># Con lÃÂ­neas verticales</span></span>
<span id="cb17-2"><a href="modelos-no-lineales.html#cb17-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df, <span class="kw">aes</span>(x, pred)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-3"><a href="modelos-no-lineales.html#cb17-3"></a><span class="st">  </span><span class="kw">geom_step</span>(<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb17-4"><a href="modelos-no-lineales.html#cb17-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> df, <span class="kw">aes</span>(x, y))</span></code></pre></div>
<p><img src="_main_files/figure-html/funciones%20a%20trozos-2.png" width="672" /></p>
</div>
<div id="splines-de-regresiãâ³n" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.4</span> Splines de regresiÃÂ³n<a href="modelos-no-lineales.html#splines-de-regresiãâ³n" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="polinomios-a-trozos" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.1</span> Polinomios a trozos<a href="modelos-no-lineales.html#polinomios-a-trozos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="modelos-no-lineales.html#cb18-1"></a><span class="co"># Ejemplo de un polinomio cÃÂºbico con 1 nodo</span></span>
<span id="cb18-2"><a href="modelos-no-lineales.html#cb18-2"></a>data.split &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, y, <span class="dt">x2cat =</span> <span class="kw">cut</span>(x, <span class="dt">breaks =</span> <span class="dv">2</span>))</span>
<span id="cb18-3"><a href="modelos-no-lineales.html#cb18-3"></a>pol.cat1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>), <span class="dt">data =</span> <span class="kw">subset</span>(data.split, x2cat <span class="op">==</span><span class="st"> &quot;(-3.06,-0.247]&quot;</span>))</span>
<span id="cb18-4"><a href="modelos-no-lineales.html#cb18-4"></a>pol.cat2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>), <span class="dt">data =</span> <span class="kw">subset</span>(data.split, x2cat <span class="op">==</span><span class="st"> &quot;(-0.247,2.57]&quot;</span>))</span>
<span id="cb18-5"><a href="modelos-no-lineales.html#cb18-5"></a>pred.polcat1 &lt;-<span class="st"> </span><span class="kw">predict</span>(pol.cat1)</span>
<span id="cb18-6"><a href="modelos-no-lineales.html#cb18-6"></a>pred.polcat2 &lt;-<span class="st"> </span><span class="kw">predict</span>(pol.cat2)</span>
<span id="cb18-7"><a href="modelos-no-lineales.html#cb18-7"></a>df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">subset</span>(data.split, x2cat <span class="op">==</span><span class="st"> &quot;(-3.06,-0.247]&quot;</span>), <span class="dt">pred =</span> pred.polcat1)</span>
<span id="cb18-8"><a href="modelos-no-lineales.html#cb18-8"></a>df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">subset</span>(data.split, x2cat <span class="op">==</span><span class="st"> &quot;(-0.247,2.57]&quot;</span>), <span class="dt">pred =</span> pred.polcat2)</span>
<span id="cb18-9"><a href="modelos-no-lineales.html#cb18-9"></a></span>
<span id="cb18-10"><a href="modelos-no-lineales.html#cb18-10"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-11"><a href="modelos-no-lineales.html#cb18-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(x, pred), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb18-12"><a href="modelos-no-lineales.html#cb18-12"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> df2, <span class="kw">aes</span>(x, pred), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb18-13"><a href="modelos-no-lineales.html#cb18-13"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> data.split, <span class="kw">aes</span>(x, y)) <span class="op">+</span></span>
<span id="cb18-14"><a href="modelos-no-lineales.html#cb18-14"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">-0.247</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/polinomios%20a%20trozos-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="modelos-no-lineales.html#cb19-1"></a><span class="co"># ComparaciÃÂ³n entre la regresiÃÂ³n polinÃÂ³mica y splines de regresiÃÂ³n</span></span>
<span id="cb19-2"><a href="modelos-no-lineales.html#cb19-2"></a><span class="kw">library</span>(splines)</span>
<span id="cb19-3"><a href="modelos-no-lineales.html#cb19-3"></a>reg.pol &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dt">degree =</span> <span class="dv">10</span>))</span>
<span id="cb19-4"><a href="modelos-no-lineales.html#cb19-4"></a><span class="kw">plot</span>(x, y, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">25</span>, <span class="dv">30</span>))</span>
<span id="cb19-5"><a href="modelos-no-lineales.html#cb19-5"></a></span>
<span id="cb19-6"><a href="modelos-no-lineales.html#cb19-6"></a>nodos &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, <span class="fl">2.5</span>, <span class="dt">length =</span> <span class="dv">10</span>) <span class="co"># UbicaciÃÂ³n de los nodos</span></span>
<span id="cb19-7"><a href="modelos-no-lineales.html#cb19-7"></a>spline.cub &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">bs</span>(x, <span class="dt">degree =</span> <span class="dv">3</span>, <span class="dt">knots =</span> nodos)) <span class="co"># Spline cÃÂºbico</span></span>
<span id="cb19-8"><a href="modelos-no-lineales.html#cb19-8"></a>spline.nat &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">ns</span>(x, <span class="dt">knots =</span> nodos)) <span class="co"># Spline natural</span></span>
<span id="cb19-9"><a href="modelos-no-lineales.html#cb19-9"></a></span>
<span id="cb19-10"><a href="modelos-no-lineales.html#cb19-10"></a><span class="co"># GrÃÂ¡ficos de los modelos</span></span>
<span id="cb19-11"><a href="modelos-no-lineales.html#cb19-11"></a>x.new &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(x), <span class="kw">max</span>(x), <span class="dt">length =</span> <span class="dv">500</span>)</span>
<span id="cb19-12"><a href="modelos-no-lineales.html#cb19-12"></a>predP &lt;-<span class="st"> </span><span class="kw">predict</span>(reg.pol, <span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> x.new)) <span class="co"># regresiÃÂ³n polinÃÂ³mica</span></span>
<span id="cb19-13"><a href="modelos-no-lineales.html#cb19-13"></a>predC &lt;-<span class="st"> </span><span class="kw">predict</span>(spline.cub, <span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> x.new)) <span class="co"># spline cÃÂºbico</span></span>
<span id="cb19-14"><a href="modelos-no-lineales.html#cb19-14"></a>predN &lt;-<span class="st"> </span><span class="kw">predict</span>(spline.nat, <span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> x.new)) <span class="co"># spline natural</span></span>
<span id="cb19-15"><a href="modelos-no-lineales.html#cb19-15"></a><span class="kw">lines</span>(x.new, predC, <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb19-16"><a href="modelos-no-lineales.html#cb19-16"></a><span class="kw">lines</span>(x.new, predP, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb19-17"><a href="modelos-no-lineales.html#cb19-17"></a><span class="kw">lines</span>(x.new, predN, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb19-18"><a href="modelos-no-lineales.html#cb19-18"></a><span class="kw">abline</span>(<span class="dt">v =</span> nodos, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb19-19"><a href="modelos-no-lineales.html#cb19-19"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Reg polinomica&quot;</span>, <span class="st">&quot;Spline C&quot;</span>, <span class="st">&quot;Spline N&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">cex =</span> <span class="fl">0.8</span>, <span class="dt">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/polinomios%20a%20trozos-2.png" width="672" /></p>
</div>
</div>
<div id="splines-de-suavizado" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.5</span> Splines de suavizado<a href="modelos-no-lineales.html#splines-de-suavizado" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="modelos-no-lineales.html#cb20-1"></a>splines.suav &lt;-<span class="st"> </span><span class="kw">smooth.spline</span>(x, y, <span class="dt">nknots =</span> <span class="dv">10</span>)</span>
<span id="cb20-2"><a href="modelos-no-lineales.html#cb20-2"></a>splines.suav.cv &lt;-<span class="st"> </span><span class="kw">smooth.spline</span>(x, y, <span class="dt">cv =</span> <span class="ot">TRUE</span>) <span class="co"># lambda ÃÂ³ptimo</span></span>
<span id="cb20-3"><a href="modelos-no-lineales.html#cb20-3"></a>splines.suav.cv<span class="op">$</span>df</span></code></pre></div>
<pre><code>## [1] 9.741308</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="modelos-no-lineales.html#cb22-1"></a>predS &lt;-<span class="st"> </span>splines.suav<span class="op">$</span>y</span>
<span id="cb22-2"><a href="modelos-no-lineales.html#cb22-2"></a>predS.cv &lt;-<span class="st"> </span>splines.suav.cv<span class="op">$</span>y</span>
<span id="cb22-3"><a href="modelos-no-lineales.html#cb22-3"></a></span>
<span id="cb22-4"><a href="modelos-no-lineales.html#cb22-4"></a><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">ncol =</span> <span class="dv">2</span>))</span>
<span id="cb22-5"><a href="modelos-no-lineales.html#cb22-5"></a><span class="kw">plot</span>(x, y, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">25</span>, <span class="dv">30</span>))</span>
<span id="cb22-6"><a href="modelos-no-lineales.html#cb22-6"></a><span class="kw">lines</span>(x.new, predC, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>) <span class="co"># spline cÃÂºbico</span></span>
<span id="cb22-7"><a href="modelos-no-lineales.html#cb22-7"></a><span class="kw">lines</span>(x.new, predN, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>) <span class="co"># spline natural</span></span>
<span id="cb22-8"><a href="modelos-no-lineales.html#cb22-8"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Spline C&quot;</span>, <span class="st">&quot;Spline N&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">cex =</span> <span class="fl">0.8</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb22-9"><a href="modelos-no-lineales.html#cb22-9"></a></span>
<span id="cb22-10"><a href="modelos-no-lineales.html#cb22-10"></a><span class="kw">plot</span>(x, y, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">25</span>, <span class="dv">30</span>))</span>
<span id="cb22-11"><a href="modelos-no-lineales.html#cb22-11"></a><span class="kw">lines</span>(<span class="kw">sort</span>(x), predS, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>) <span class="co"># spline de suavizado</span></span>
<span id="cb22-12"><a href="modelos-no-lineales.html#cb22-12"></a><span class="kw">lines</span>(<span class="kw">sort</span>(x), predS.cv, <span class="dt">col =</span> <span class="st">&quot;darkorchid&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb22-13"><a href="modelos-no-lineales.html#cb22-13"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Spline C k = 10&quot;</span>, <span class="st">&quot;Spline C optimo&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">cex =</span> <span class="fl">0.8</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/splines%20de%20suavizado-1.png" width="672" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="modelos-no-lineales.html#cb23-1"></a><span class="kw">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="modelos-aditivos-generalizados" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.6</span> Modelos aditivos generalizados<a href="modelos-no-lineales.html#modelos-aditivos-generalizados" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Gillibrand et al. (2007) analizaron la bioluminiscencia pelÃÂ¡gica (Sources) a lo largo de un gradiente de profundidad (SampleDepth) en el NE del OcÃÂ©ano AtlÃÂ¡ntico (ISIT.txt).</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="modelos-no-lineales.html#cb24-1"></a><span class="kw">library</span>(lattice)</span>
<span id="cb24-2"><a href="modelos-no-lineales.html#cb24-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb24-3"><a href="modelos-no-lineales.html#cb24-3"></a><span class="kw">library</span>(mgcv)</span></code></pre></div>
<pre><code>## Loading required package: nlme</code></pre>
<pre><code>## This is mgcv 1.8-31. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="modelos-no-lineales.html#cb27-1"></a><span class="kw">library</span>(gratia)</span></code></pre></div>
<pre><code>## Warning: package &#39;gratia&#39; was built under R version 4.0.5</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="modelos-no-lineales.html#cb29-1"></a>biolum &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;C:/RD/ISIT.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb29-2"><a href="modelos-no-lineales.html#cb29-2"></a><span class="kw">str</span>(biolum)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    789 obs. of  14 variables:
##  $ SampleDepth  : num  517 582 547 614 1068 ...
##  $ Sources      : num  28.7 27.9 23.4 18.3 12.4 ...
##  $ Station      : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ Time         : int  3 3 3 3 3 3 3 3 3 3 ...
##  $ Latitude     : num  50.2 50.2 50.2 50.2 50.2 ...
##  $ Longitude    : num  -14.5 -14.5 -14.5 -14.5 -14.5 ...
##  $ Xkm          : num  -34.1 -34.1 -34.1 -34.1 -34.1 ...
##  $ Ykm          : num  16.8 16.8 16.8 16.8 16.8 ...
##  $ Month        : int  4 4 4 4 4 4 4 4 4 4 ...
##  $ Year         : int  2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 ...
##  $ BottomDepth  : int  3939 3939 3939 3939 3939 3939 3939 3939 3939 3939 ...
##  $ Season       : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ Discovery    : int  252 252 252 252 252 252 252 252 252 252 ...
##  $ RelativeDepth: num  3422 3357 3392 3325 2871 ...</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="modelos-no-lineales.html#cb31-1"></a>biolum<span class="op">$</span>Month &lt;-<span class="st"> </span><span class="kw">as.factor</span>(biolum<span class="op">$</span>Month)</span>
<span id="cb31-2"><a href="modelos-no-lineales.html#cb31-2"></a><span class="kw">xyplot</span>(Sources <span class="op">~</span><span class="st"> </span>SampleDepth<span class="op">|</span>Month, <span class="dt">data =</span> biolum)</span></code></pre></div>
<p><img src="_main_files/figure-html/GAMs-1.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="modelos-no-lineales.html#cb32-1"></a><span class="co"># GAM con spline natural</span></span>
<span id="cb32-2"><a href="modelos-no-lineales.html#cb32-2"></a>gam1 &lt;-<span class="st"> </span><span class="kw">lm</span>(Sources <span class="op">~</span><span class="st"> </span><span class="kw">ns</span>(SampleDepth, <span class="dt">df =</span> <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span>Month, <span class="dt">data =</span> biolum)</span>
<span id="cb32-3"><a href="modelos-no-lineales.html#cb32-3"></a><span class="co"># GAM con spline de suavizado (5 nodos)</span></span>
<span id="cb32-4"><a href="modelos-no-lineales.html#cb32-4"></a>gam2 &lt;-<span class="st"> </span><span class="kw">gam</span>(Sources <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(SampleDepth, <span class="dt">k =</span> <span class="dv">5</span>, <span class="dt">bs =</span> <span class="st">&quot;cr&quot;</span>) <span class="op">+</span><span class="st"> </span>Month, <span class="dt">method =</span> <span class="st">&quot;REML&quot;</span>, <span class="dt">data =</span> biolum)</span>
<span id="cb32-5"><a href="modelos-no-lineales.html#cb32-5"></a><span class="co"># GAM con spline de suavizado (validaciÃÂ³n cruzada)</span></span>
<span id="cb32-6"><a href="modelos-no-lineales.html#cb32-6"></a>gam3 &lt;-<span class="st"> </span><span class="kw">gam</span>(Sources <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(SampleDepth, <span class="dt">bs =</span> <span class="st">&quot;cr&quot;</span>) <span class="op">+</span><span class="st"> </span>Month, <span class="dt">method =</span> <span class="st">&quot;REML&quot;</span>, <span class="dt">data =</span> biolum)</span>
<span id="cb32-7"><a href="modelos-no-lineales.html#cb32-7"></a><span class="kw">summary</span>(gam1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Sources ~ ns(SampleDepth, df = 5) + Month, data = biolum)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -22.611  -3.938  -1.187   2.773  53.871 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)               27.6560     1.1940  23.162  &lt; 2e-16 ***
## ns(SampleDepth, df = 5)1  -8.2891     1.3547  -6.119 1.49e-09 ***
## ns(SampleDepth, df = 5)2 -33.3891     1.6318 -20.462  &lt; 2e-16 ***
## ns(SampleDepth, df = 5)3 -19.1238     1.5363 -12.448  &lt; 2e-16 ***
## ns(SampleDepth, df = 5)4 -47.0388     2.8279 -16.634  &lt; 2e-16 ***
## ns(SampleDepth, df = 5)5 -27.4261     1.8643 -14.711  &lt; 2e-16 ***
## Month4                    -0.6579     0.8180  -0.804    0.421    
## Month8                     5.4249     0.6470   8.385 2.37e-16 ***
## Month10                    6.3520     0.7025   9.042  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.842 on 780 degrees of freedom
## Multiple R-squared:  0.663,  Adjusted R-squared:  0.6595 
## F-statistic: 191.8 on 8 and 780 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="modelos-no-lineales.html#cb34-1"></a><span class="kw">summary</span>(gam2)</span></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## Sources ~ s(SampleDepth, k = 5, bs = &quot;cr&quot;) + Month
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   7.1165     0.5068  14.043   &lt;2e-16 ***
## Month4        0.8195     0.8403   0.975     0.33    
## Month8        5.7935     0.6787   8.536   &lt;2e-16 ***
## Month10       6.6598     0.7378   9.026   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                 edf Ref.df     F p-value    
## s(SampleDepth) 3.51  3.855 309.3  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.623   Deviance explained = 62.6%
## -REML = 2676.1  Scale est. = 51.787    n = 789</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="modelos-no-lineales.html#cb36-1"></a><span class="kw">summary</span>(gam3)</span></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## Sources ~ s(SampleDepth, bs = &quot;cr&quot;) + Month
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   7.4895     0.4611  16.243   &lt;2e-16 ***
## Month4       -0.6242     0.7879  -0.792    0.428    
## Month8        5.4546     0.6157   8.859   &lt;2e-16 ***
## Month10       6.5317     0.6695   9.755   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                  edf Ref.df     F p-value    
## s(SampleDepth) 8.562  8.933 182.3  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.692   Deviance explained = 69.6%
## -REML = 2611.8  Scale est. = 42.399    n = 789</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="modelos-no-lineales.html#cb38-1"></a><span class="co"># GrÃÂ¡ficos del modelo</span></span>
<span id="cb38-2"><a href="modelos-no-lineales.html#cb38-2"></a>SampleDepth &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(biolum<span class="op">$</span>SampleDepth), <span class="kw">max</span>(biolum<span class="op">$</span>SampleDepth), <span class="dt">length =</span> <span class="dv">100</span>)</span>
<span id="cb38-3"><a href="modelos-no-lineales.html#cb38-3"></a>Month &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">unique</span>(biolum<span class="op">$</span>Month))</span>
<span id="cb38-4"><a href="modelos-no-lineales.html#cb38-4"></a>newdata &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">SampleDepth =</span> SampleDepth, <span class="dt">Month =</span> Month)</span>
<span id="cb38-5"><a href="modelos-no-lineales.html#cb38-5"></a>newdata<span class="op">$</span>pred_gam1 &lt;-<span class="st"> </span><span class="kw">predict</span>(gam1, <span class="dt">newdata =</span> newdata)</span>
<span id="cb38-6"><a href="modelos-no-lineales.html#cb38-6"></a>newdata<span class="op">$</span>pred_gam2 &lt;-<span class="st"> </span><span class="kw">predict</span>(gam2, <span class="dt">newdata =</span> newdata)</span>
<span id="cb38-7"><a href="modelos-no-lineales.html#cb38-7"></a>newdata<span class="op">$</span>pred_gam3 &lt;-<span class="st"> </span><span class="kw">predict</span>(gam3, <span class="dt">newdata =</span> newdata)</span>
<span id="cb38-8"><a href="modelos-no-lineales.html#cb38-8"></a></span>
<span id="cb38-9"><a href="modelos-no-lineales.html#cb38-9"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data =</span> biolum, <span class="kw">aes</span>(<span class="dt">x =</span> SampleDepth, <span class="dt">y =</span> Sources, <span class="dt">color =</span> Month)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Month) <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-10"><a href="modelos-no-lineales.html#cb38-10"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> newdata, <span class="kw">aes</span>(<span class="dt">x =</span> SampleDepth, <span class="dt">y =</span> pred_gam1), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb38-11"><a href="modelos-no-lineales.html#cb38-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> newdata, <span class="kw">aes</span>(<span class="dt">x =</span> SampleDepth, <span class="dt">y =</span> pred_gam2), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/GAMs-2.png" width="672" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="modelos-no-lineales.html#cb39-1"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data =</span> biolum, <span class="kw">aes</span>(<span class="dt">x =</span> SampleDepth, <span class="dt">y =</span> Sources, <span class="dt">color =</span> Month)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Month) <span class="op">+</span><span class="st"> </span></span>
<span id="cb39-2"><a href="modelos-no-lineales.html#cb39-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> newdata, <span class="kw">aes</span>(<span class="dt">x =</span> SampleDepth, <span class="dt">y =</span> pred_gam3), <span class="dt">color =</span> <span class="st">&quot;coral&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/GAMs-3.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="modelos-no-lineales.html#cb40-1"></a><span class="kw">draw</span>(gam2)</span></code></pre></div>
<p><img src="_main_files/figure-html/GAMs-4.png" width="672" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="modelos-no-lineales.html#cb41-1"></a><span class="kw">draw</span>(gam3)</span></code></pre></div>
<p><img src="_main_files/figure-html/GAMs-5.png" width="672" /></p>
<div id="gam-con-otras-distribuciones-e-interacciones" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.6.1</span> GAM con otras distribuciones e interacciones<a href="modelos-no-lineales.html#gam-con-otras-distribuciones-e-interacciones" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="modelos-no-lineales.html#cb42-1"></a>biolum<span class="op">$</span>Sources_<span class="fl">0.1</span> &lt;-<span class="st"> </span>biolum<span class="op">$</span>Sources <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb42-2"><a href="modelos-no-lineales.html#cb42-2"></a><span class="co"># Modelo sin interacciÃÂ³n</span></span>
<span id="cb42-3"><a href="modelos-no-lineales.html#cb42-3"></a>gam4 &lt;-<span class="st"> </span><span class="kw">gam</span>(Sources_<span class="fl">0.1</span> <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(SampleDepth, <span class="dt">bs =</span> <span class="st">&quot;cr&quot;</span>) <span class="op">+</span><span class="st"> </span>Month, <span class="dt">family =</span> Gamma, <span class="dt">method =</span> <span class="st">&quot;REML&quot;</span>, <span class="dt">data =</span> biolum)</span>
<span id="cb42-4"><a href="modelos-no-lineales.html#cb42-4"></a><span class="kw">summary</span>(gam4)</span></code></pre></div>
<pre><code>## 
## Family: Gamma 
## Link function: inverse 
## 
## Formula:
## Sources_0.1 ~ s(SampleDepth, bs = &quot;cr&quot;) + Month
## 
## Parametric coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.436845   0.014114  30.951  &lt; 2e-16 ***
## Month4       0.006954   0.006530   1.065    0.287    
## Month8      -0.032625   0.004367  -7.471 2.14e-13 ***
## Month10     -0.029611   0.004283  -6.913 9.90e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                  edf Ref.df     F p-value    
## s(SampleDepth) 7.175  7.952 134.8  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.594   Deviance explained = 81.6%
## -REML = 1942.5  Scale est. = 0.31488   n = 789</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="modelos-no-lineales.html#cb44-1"></a>SampleDepth &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(biolum<span class="op">$</span>SampleDepth), <span class="dv">4000</span>, <span class="dt">length =</span> <span class="dv">100</span>)</span>
<span id="cb44-2"><a href="modelos-no-lineales.html#cb44-2"></a>newdata &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">SampleDepth =</span> SampleDepth, <span class="dt">Month =</span> Month)</span>
<span id="cb44-3"><a href="modelos-no-lineales.html#cb44-3"></a>newdata<span class="op">$</span>pred_gam4 &lt;-<span class="st"> </span><span class="kw">predict</span>(gam4, <span class="dt">newdata =</span> newdata, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb44-4"><a href="modelos-no-lineales.html#cb44-4"></a></span>
<span id="cb44-5"><a href="modelos-no-lineales.html#cb44-5"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data =</span> biolum, <span class="kw">aes</span>(<span class="dt">x =</span> SampleDepth, <span class="dt">y =</span> Sources, <span class="dt">color =</span> Month)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Month) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-6"><a href="modelos-no-lineales.html#cb44-6"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> newdata, <span class="kw">aes</span>(<span class="dt">x =</span> SampleDepth, <span class="dt">y =</span> pred_gam4), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/GAM%20Gamma-1.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="modelos-no-lineales.html#cb45-1"></a><span class="kw">draw</span>(gam4)</span></code></pre></div>
<p><img src="_main_files/figure-html/GAM%20Gamma-2.png" width="672" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="modelos-no-lineales.html#cb46-1"></a><span class="co"># Modelo con interacciÃÂ³n (variable continua y categÃÂ³rica)</span></span>
<span id="cb46-2"><a href="modelos-no-lineales.html#cb46-2"></a>gam5 &lt;-<span class="st"> </span><span class="kw">gam</span>(Sources_<span class="fl">0.1</span> <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(SampleDepth) <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(SampleDepth, <span class="dt">by =</span> Month, <span class="dt">bs =</span> <span class="st">&quot;cr&quot;</span>), <span class="dt">family =</span> Gamma, <span class="dt">method =</span> <span class="st">&quot;REML&quot;</span>, <span class="dt">data =</span> biolum)</span>
<span id="cb46-3"><a href="modelos-no-lineales.html#cb46-3"></a></span>
<span id="cb46-4"><a href="modelos-no-lineales.html#cb46-4"></a>SampleDepth &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(biolum<span class="op">$</span>SampleDepth), <span class="dv">4000</span>, <span class="dt">length =</span> <span class="dv">100</span>)</span>
<span id="cb46-5"><a href="modelos-no-lineales.html#cb46-5"></a>newdata &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">SampleDepth =</span> SampleDepth, <span class="dt">Month =</span> Month)</span>
<span id="cb46-6"><a href="modelos-no-lineales.html#cb46-6"></a>newdata<span class="op">$</span>pred_gam5 &lt;-<span class="st"> </span><span class="kw">predict</span>(gam5, <span class="dt">newdata =</span> newdata, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb46-7"><a href="modelos-no-lineales.html#cb46-7"></a></span>
<span id="cb46-8"><a href="modelos-no-lineales.html#cb46-8"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data =</span> biolum, <span class="kw">aes</span>(<span class="dt">x =</span> SampleDepth, <span class="dt">y =</span> Sources, <span class="dt">color =</span> Month)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Month) <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-9"><a href="modelos-no-lineales.html#cb46-9"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> newdata, <span class="kw">aes</span>(<span class="dt">x =</span> SampleDepth, <span class="dt">y =</span> pred_gam5), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/GAM%20Gamma-3.png" width="672" /></p>
</div>
<div id="comparaciãâ³n-de-modelos" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.6.2</span> ComparaciÃÂ³n de modelos<a href="modelos-no-lineales.html#comparaciãâ³n-de-modelos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="modelos-no-lineales.html#cb47-1"></a><span class="kw">anova</span>(gam4, gam5, <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: Sources_0.1 ~ s(SampleDepth, bs = &quot;cr&quot;) + Month
## Model 2: Sources_0.1 ~ s(SampleDepth) + s(SampleDepth, by = Month, bs = &quot;cr&quot;)
##   Resid. Df Resid. Dev     Df Deviance      F    Pr(&gt;F)    
## 1    776.82     235.36                                     
## 2    757.48     153.06 19.342   82.293 21.586 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="modelos-no-lineales.html#cb49-1"></a><span class="kw">AIC</span>(gam4, gam5)</span></code></pre></div>
<pre><code>##            df      AIC
## gam4 12.40166 3835.591
## gam5 30.20737 3518.103</code></pre>
</div>
<div id="validaciãâ³n" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.6.3</span> ValidaciÃÂ³n<a href="modelos-no-lineales.html#validaciãâ³n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="modelos-no-lineales.html#cb51-1"></a><span class="kw">gam.check</span>(gam5)</span></code></pre></div>
<p><img src="_main_files/figure-html/diagnosticos-1.png" width="672" /></p>
<pre><code>## 
## Method: REML   Optimizer: outer newton
## full convergence after 18 iterations.
## Gradient range [-0.000865356,0.002459346]
## (score 1810.495 &amp; scale 0.1970945).
## Hessian positive definite, eigenvalue range [0.0008651971,416.9648].
## Model rank =  45 / 46 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                          k&#39;  edf k-index p-value
## s(SampleDepth)         9.00 6.61    1.01    0.82
## s(SampleDepth):Month3  9.00 7.59    1.01    0.80
## s(SampleDepth):Month4  9.00 7.61    1.01    0.82
## s(SampleDepth):Month8  9.00 1.01    1.01    0.80
## s(SampleDepth):Month10 9.00 3.07    1.01    0.81</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="modelos-no-lineales.html#cb53-1"></a><span class="kw">appraise</span>(gam5, <span class="dt">method =</span> <span class="st">&quot;simulate&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/diagnosticos-2.png" width="672" /></p>
</div>
<div id="modelo-con-variables-continuas-efectos-principales-interacciones" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.6.4</span> Modelo con variables continuas (efectos principales + interacciones)<a href="modelos-no-lineales.html#modelo-con-variables-continuas-efectos-principales-interacciones" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Palacio et al. (2017) estudiaron el consumo de frutos por aves en <span class="math inline">\(Psychotria carthagenensis\)</span> en un bosque secundario pedemontano de las Yungas (Psychotria_El_Corte_2012.txt). Se ajustÃÂ³ un GAM del nÃÂºmero de infrutescencias (n.infrut) en funciÃÂ³n de las coordenadas (x = longitud, y = latitud).</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="modelos-no-lineales.html#cb54-1"></a><span class="kw">library</span>(fields)</span></code></pre></div>
<pre><code>## Loading required package: spam</code></pre>
<pre><code>## Loading required package: dotCall64</code></pre>
<pre><code>## Loading required package: grid</code></pre>
<pre><code>## Spam version 2.5-1 (2019-12-12) is loaded.
## Type &#39;help( Spam)&#39; or &#39;demo( spam)&#39; for a short introduction 
## and overview of this package.
## Help for individual functions is also obtained by adding the
## suffix &#39;.spam&#39; to the function name, e.g. &#39;help( chol.spam)&#39;.</code></pre>
<pre><code>## 
## Attaching package: &#39;spam&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     backsolve, forwardsolve</code></pre>
<pre><code>## Loading required package: maps</code></pre>
<pre><code>## See https://github.com/NCAR/Fields for
##  an extensive vignette, other supplements and source code</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="modelos-no-lineales.html#cb63-1"></a>psycho &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;C:/RD/Psychotria_El_Corte_2012.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb63-2"><a href="modelos-no-lineales.html#cb63-2"></a><span class="kw">str</span>(psycho)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    72 obs. of  14 variables:
##  $ planta     : chr  &quot;A2-1&quot; &quot;A2-2&quot; &quot;A2-3&quot; &quot;A2-4&quot; ...
##  $ celda      : chr  &quot;A2&quot; &quot;A2&quot; &quot;A2&quot; &quot;A2&quot; ...
##  $ y          : num  7036536 7036536 7036535 7036537 7036561 ...
##  $ x          : num  3566229 3566237 3566217 3566202 3566108 ...
##  $ n.infrut   : int  7 7 8 7 12 3 12 4 9 10 ...
##  $ copa       : num  1.18 1.47 1.29 1.26 1.79 1.17 1.63 0.85 1.26 1.26 ...
##  $ vecino     : num  0.58 0.31 0.52 0.6 0.66 0.98 1.5 0.2 0.65 0.71 ...
##  $ x.diam     : num  7.37 7.53 7.14 7.33 6.95 ...
##  $ x.peso     : num  0.27 0.29 0.248 0.275 0.204 0.134 0.27 0.184 0.29 0.227 ...
##  $ x.az       : num  9.85 12.4 10.45 11.05 11.1 ...
##  $ x.pulpa    : num  0.237 0.245 0.213 0.245 0.177 0.11 0.227 0.157 0.249 0.198 ...
##  $ x.sem      : num  0.033 0.044 0.035 0.03 0.027 0.029 0.042 0.027 0.041 0.029 ...
##  $ p.a.visitas: int  0 0 0 0 0 0 0 0 0 0 ...
##  $ frut.cons  : int  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="modelos-no-lineales.html#cb65-1"></a><span class="kw">hist</span>(psycho<span class="op">$</span>n.infrut, <span class="dt">xlab =</span> <span class="st">&quot;Numero de infrutescencias&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Frecuencia&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/2%20vars%20gam-1.png" width="672" /></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="modelos-no-lineales.html#cb66-1"></a>gam6 &lt;-<span class="st"> </span><span class="kw">gam</span>(n.infrut <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x, y), <span class="dt">family =</span> nb, <span class="dt">method =</span> <span class="st">&quot;REML&quot;</span>, <span class="dt">data =</span> psycho)</span>
<span id="cb66-2"><a href="modelos-no-lineales.html#cb66-2"></a><span class="kw">summary</span>(gam6)</span></code></pre></div>
<pre><code>## 
## Family: Negative Binomial(3.575) 
## Link function: log 
## 
## Formula:
## n.infrut ~ s(x, y)
## 
## Parametric coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  2.70250    0.06996   38.63   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##          edf Ref.df Chi.sq  p-value    
## s(x,y) 10.75   14.2  42.44 0.000121 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.277   Deviance explained = 48.5%
## -REML = 263.61  Scale est. = 1         n = 72</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="modelos-no-lineales.html#cb68-1"></a>gam7 &lt;-<span class="st"> </span><span class="kw">gam</span>(n.infrut <span class="op">~</span><span class="st"> </span><span class="kw">te</span>(x, y), <span class="dt">family =</span> nb, <span class="dt">method =</span> <span class="st">&quot;REML&quot;</span>, <span class="dt">data =</span> psycho) </span>
<span id="cb68-2"><a href="modelos-no-lineales.html#cb68-2"></a><span class="kw">summary</span>(gam7)</span></code></pre></div>
<pre><code>## 
## Family: Negative Binomial(2.828) 
## Link function: log 
## 
## Formula:
## n.infrut ~ te(x, y)
## 
## Parametric coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  2.74392    0.07664    35.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##           edf Ref.df Chi.sq p-value   
## te(x,y) 6.132  7.822  24.71  0.0014 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.151   Deviance explained = 31.5%
## -REML = 260.36  Scale est. = 1         n = 72</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="modelos-no-lineales.html#cb70-1"></a>gam8 &lt;-<span class="st"> </span><span class="kw">Tps</span>(<span class="dt">x =</span> <span class="kw">data.frame</span>(<span class="dt">Latitud =</span> psycho<span class="op">$</span>x, <span class="dt">Longitud =</span> psycho<span class="op">$</span>y), <span class="dt">Y =</span> psycho<span class="op">$</span>n.infrut)</span>
<span id="cb70-2"><a href="modelos-no-lineales.html#cb70-2"></a></span>
<span id="cb70-3"><a href="modelos-no-lineales.html#cb70-3"></a><span class="co"># Superficies de respuesta</span></span>
<span id="cb70-4"><a href="modelos-no-lineales.html#cb70-4"></a><span class="kw">draw</span>(gam6)</span></code></pre></div>
<p><img src="_main_files/figure-html/2%20vars%20gam-2.png" width="672" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="modelos-no-lineales.html#cb71-1"></a><span class="kw">draw</span>(gam7)</span></code></pre></div>
<p><img src="_main_files/figure-html/2%20vars%20gam-3.png" width="672" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="modelos-no-lineales.html#cb72-1"></a><span class="kw">surface</span>(gam8)</span></code></pre></div>
<p><img src="_main_files/figure-html/2%20vars%20gam-4.png" width="672" /></p>
</div>
</div>
<div id="actividades-3" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.7</span> Actividades<a href="modelos-no-lineales.html#actividades-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ejercicio-4.2" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.7.1</span> Ejercicio 4.2<a href="modelos-no-lineales.html#ejercicio-4.2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Wingfield et al. (2017) estudiaron la dinÃÂ¡mica espaciotemporal de <em>Phocoena phocoena</em> (Pinnipedia, Mammalia) en Maryland, Estados Unidos. Se quiere establecer en que ÃÂ©poca del aÃÂ±o es mÃÂ¡s frecuente detectarla y los determinantes de su distribuciÃÂ³n. Para esto se realizaron muestreos durante 18 meses y se recolectÃÂ³ informaciÃÂ³n sobre la temperatura de la superficie del agua (<strong>SST</strong>) y la concentraciÃÂ³n de clorofila, expresada como logaritmo (<strong>lnCHL</strong>).</p>
<ul>
<li><p>Utilice un modelo que describa la dinÃÂ¡mica temporal de la proporciÃÂ³n de detecciones de la especie.</p></li>
<li><p>Identifique quÃÂ© variables se relacionan con la proporciÃÂ³n de detecciones.</p></li>
<li><p>Construya una tabla que represente los resultados principales.</p></li>
<li><p>Grafique el modelo como considere mÃÂ¡s conveniente para mostrar los resultados.</p></li>
<li><p>ÃÂ¿QuÃÂ© conclusiones obtiene en tÃÂ©rminos biolÃÂ³gicos?</p></li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelos-lineales-generalizados.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
